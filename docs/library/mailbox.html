<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>18.3. mailbox — Manipulate mailboxes in various formats &mdash; Jython v2.5.2 documentation</title>
    <link rel="stylesheet" href="../_static/green-theme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '2.5.2',
        COLLAPSE_MODINDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="copyright" title="Copyright" href="../copyright.html" />
    <link rel="top" title="Jython v2.5.2 documentation" href="../index.html" />
    <link rel="up" title="18. Internet Data Handling" href="netdata.html" />
    <link rel="next" title="18.4. mhlib — Access to MH mailboxes" href="mhlib.html" />
    <link rel="prev" title="18.2. mailcap — Mailcap file handling" href="mailcap.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../modindex.html" title="Global Module Index"
             accesskey="M">modules</a> |</li>
        <li class="right" >
          <a href="mhlib.html" title="18.4. mhlib — Access to MH mailboxes"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="mailcap.html" title="18.2. mailcap — Mailcap file handling"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">Jython v2.5.2 documentation</a> &raquo;</li>
          <li><a href="indexprogress.html" >The Python Standard Library and What Comes with Jython</a> &raquo;</li>
          <li><a href="netdata.html" accesskey="U">18. Internet Data Handling</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/jython.png" alt="Logo"/>
            </a></p>
            <h3><a href="../index.html">Table Of Contents</a></h3>
            <ul>
<li><a class="reference external" href="#">18.3. <tt class="docutils literal"><span class="pre">mailbox</span></tt> &#8212; Manipulate mailboxes in various formats</a><ul>
<li><a class="reference external" href="#mailbox-objects">18.3.1. <tt class="docutils literal"><span class="pre">Mailbox</span></tt> objects</a><ul>
<li><a class="reference external" href="#maildir">18.3.1.1. <tt class="docutils literal"><span class="pre">Maildir</span></tt></a></li>
<li><a class="reference external" href="#mbox">18.3.1.2. <tt class="docutils literal"><span class="pre">mbox</span></tt></a></li>
<li><a class="reference external" href="#mh">18.3.1.3. <tt class="docutils literal"><span class="pre">MH</span></tt></a></li>
<li><a class="reference external" href="#babyl">18.3.1.4. <tt class="docutils literal"><span class="pre">Babyl</span></tt></a></li>
<li><a class="reference external" href="#mmdf">18.3.1.5. <tt class="docutils literal"><span class="pre">MMDF</span></tt></a></li>
</ul>
</li>
<li><a class="reference external" href="#message-objects">18.3.2. <tt class="docutils literal"><span class="pre">Message</span></tt> objects</a><ul>
<li><a class="reference external" href="#maildirmessage">18.3.2.1. <tt class="docutils literal"><span class="pre">MaildirMessage</span></tt></a></li>
<li><a class="reference external" href="#mboxmessage">18.3.2.2. <tt class="docutils literal"><span class="pre">mboxMessage</span></tt></a></li>
<li><a class="reference external" href="#mhmessage">18.3.2.3. <tt class="docutils literal"><span class="pre">MHMessage</span></tt></a></li>
<li><a class="reference external" href="#babylmessage">18.3.2.4. <tt class="docutils literal"><span class="pre">BabylMessage</span></tt></a></li>
<li><a class="reference external" href="#mmdfmessage">18.3.2.5. <tt class="docutils literal"><span class="pre">MMDFMessage</span></tt></a></li>
</ul>
</li>
<li><a class="reference external" href="#exceptions">18.3.3. Exceptions</a></li>
<li><a class="reference external" href="#deprecated-classes-and-methods">18.3.4. Deprecated classes and methods</a></li>
<li><a class="reference external" href="#examples">18.3.5. Examples</a></li>
</ul>
</li>
</ul>

            <h4>Previous topic</h4>
            <p class="topless"><a href="mailcap.html"
                                  title="previous chapter">18.2. <tt class="docutils literal docutils literal"><span class="pre">mailcap</span></tt> &#8212; Mailcap file handling</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="mhlib.html"
                                  title="next chapter">18.4. <tt class="docutils literal"><span class="pre">mhlib</span></tt> &#8212; Access to MH mailboxes</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="../_sources/library/mailbox.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="../search.html" method="get">
                <input type="text" name="q" size="18" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="mailbox-manipulate-mailboxes-in-various-formats">
<h1>18.3. <tt class="docutils literal"><span class="pre">mailbox</span></tt> &#8212; Manipulate mailboxes in various formats<a class="headerlink" href="#mailbox-manipulate-mailboxes-in-various-formats" title="Permalink to this headline">¶</a></h1>
<p>This module defines two classes, <tt class="docutils literal"><span class="pre">Mailbox</span></tt> and <tt class="docutils literal"><span class="pre">Message</span></tt>, for
accessing and manipulating on-disk mailboxes and the messages they
contain. <tt class="docutils literal"><span class="pre">Mailbox</span></tt> offers a dictionary-like mapping from keys to
messages. <tt class="docutils literal"><span class="pre">Message</span></tt> extends the <tt class="docutils literal"><span class="pre">email.Message</span></tt> module&#8217;s
<tt class="docutils literal"><span class="pre">Message</span></tt> class with format-specific state and behavior. Supported
mailbox formats are Maildir, mbox, MH, Babyl, and MMDF.</p>
<p>See also:</p>
<blockquote>
<dl class="docutils">
<dt>Module <tt class="docutils literal"><span class="pre">email</span></tt></dt>
<dd>Represent and manipulate messages.</dd>
</dl>
</blockquote>
<div class="section" id="mailbox-objects">
<h2>18.3.1. <tt class="docutils literal"><span class="pre">Mailbox</span></tt> objects<a class="headerlink" href="#mailbox-objects" title="Permalink to this headline">¶</a></h2>
<p>class class mailbox.Mailbox</p>
<blockquote>
<p>A mailbox, which may be inspected and modified.</p>
<p>The <tt class="docutils literal"><span class="pre">Mailbox</span></tt> class defines an interface and is not intended to
be instantiated.  Instead, format-specific subclasses should
inherit from <tt class="docutils literal"><span class="pre">Mailbox</span></tt> and your code should instantiate a
particular subclass.</p>
<p>The <tt class="docutils literal"><span class="pre">Mailbox</span></tt> interface is dictionary-like, with small keys
corresponding to messages. Keys are issued by the <tt class="docutils literal"><span class="pre">Mailbox</span></tt>
instance with which they will be used and are only meaningful to
that <tt class="docutils literal"><span class="pre">Mailbox</span></tt> instance. A key continues to identify a message
even if the corresponding message is modified, such as by replacing
it with another message.</p>
<p>Messages may be added to a <tt class="docutils literal"><span class="pre">Mailbox</span></tt> instance using the set-like
method <tt class="docutils literal"><span class="pre">add()</span></tt> and removed using a <tt class="docutils literal"><span class="pre">del</span></tt> statement or the set-
like methods <tt class="docutils literal"><span class="pre">remove()</span></tt> and <tt class="docutils literal"><span class="pre">discard()</span></tt>.</p>
<p><tt class="docutils literal"><span class="pre">Mailbox</span></tt> interface semantics differ from dictionary semantics in
some noteworthy ways. Each time a message is requested, a new
representation (typically a <tt class="docutils literal"><span class="pre">Message</span></tt> instance) is generated
based upon the current state of the mailbox. Similarly, when a
message is added to a <tt class="docutils literal"><span class="pre">Mailbox</span></tt> instance, the provided message
representation&#8217;s contents are copied. In neither case is a
reference to the message representation kept by the <tt class="docutils literal"><span class="pre">Mailbox</span></tt>
instance.</p>
<p>The default <tt class="docutils literal"><span class="pre">Mailbox</span></tt> iterator iterates over message
representations, not keys as the default dictionary iterator does.
Moreover, modification of a mailbox during iteration is safe and
well-defined. Messages added to the mailbox after an iterator is
created will not be seen by the iterator. Messages removed from the
mailbox before the iterator yields them will be silently skipped,
though using a key from an iterator may result in a <tt class="docutils literal"><span class="pre">KeyError</span></tt>
exception if the corresponding message is subsequently removed.</p>
<dl class="docutils">
<dt>Warning: Be very cautious when modifying mailboxes that might be</dt>
<dd>simultaneously changed by some other process.  The safest mailbox
format to use for such tasks is Maildir; try to avoid using
single-file formats such as mbox for concurrent writing.  If
you&#8217;re modifying a mailbox, you <em>must</em> lock it by calling the
<tt class="docutils literal"><span class="pre">lock()</span></tt> and <tt class="docutils literal"><span class="pre">unlock()</span></tt> methods <em>before</em> reading any messages
in the file or making any changes by adding or deleting a
message.  Failing to lock the mailbox runs the risk of losing
messages or corrupting the entire mailbox.</dd>
</dl>
<p><tt class="docutils literal"><span class="pre">Mailbox</span></tt> instances have the following methods:</p>
<p>add(message)</p>
<blockquote>
<p>Add <em>message</em> to the mailbox and return the key that has been
assigned to it.</p>
<p>Parameter <em>message</em> may be a <tt class="docutils literal"><span class="pre">Message</span></tt> instance, an
<tt class="docutils literal"><span class="pre">email.Message.Message</span></tt> instance, a string, or a file-like
object (which should be open in text mode). If <em>message</em> is an
instance of the appropriate format-specific <tt class="docutils literal"><span class="pre">Message</span></tt> subclass
(e.g., if it&#8217;s an <tt class="docutils literal"><span class="pre">mboxMessage</span></tt> instance and this is an
<tt class="docutils literal"><span class="pre">mbox</span></tt> instance), its format-specific information is used.
Otherwise, reasonable defaults for format-specific information
are used.</p>
</blockquote>
<p>remove(key)
__delitem__(key)
discard(key)</p>
<blockquote>
<p>Delete the message corresponding to <em>key</em> from the mailbox.</p>
<p>If no such message exists, a <tt class="docutils literal"><span class="pre">KeyError</span></tt> exception is raised if
the method was called as <tt class="docutils literal"><span class="pre">remove()</span></tt> or <tt class="docutils literal"><span class="pre">__delitem__()</span></tt> but
no exception is raised if the method was called as
<tt class="docutils literal"><span class="pre">discard()</span></tt>. The behavior of <tt class="docutils literal"><span class="pre">discard()</span></tt> may be preferred if
the underlying mailbox format supports concurrent modification
by other processes.</p>
</blockquote>
<p>__setitem__(key, message)</p>
<blockquote>
<p>Replace the message corresponding to <em>key</em> with <em>message</em>. Raise
a <tt class="docutils literal"><span class="pre">KeyError</span></tt> exception if no message already corresponds to
<em>key</em>.</p>
<p>As with <tt class="docutils literal"><span class="pre">add()</span></tt>, parameter <em>message</em> may be a <tt class="docutils literal"><span class="pre">Message</span></tt>
instance, an <tt class="docutils literal"><span class="pre">email.Message.Message</span></tt> instance, a string, or a
file-like object (which should be open in text mode). If
<em>message</em> is an instance of the appropriate format-specific
<tt class="docutils literal"><span class="pre">Message</span></tt> subclass (e.g., if it&#8217;s an <tt class="docutils literal"><span class="pre">mboxMessage</span></tt> instance
and this is an <tt class="docutils literal"><span class="pre">mbox</span></tt> instance), its format-specific
information is used. Otherwise, the format-specific information
of the message that currently corresponds to <em>key</em> is left
unchanged.</p>
</blockquote>
<p>iterkeys()
keys()</p>
<blockquote>
Return an iterator over all keys if called as <tt class="docutils literal"><span class="pre">iterkeys()</span></tt> or
return a list of keys if called as <tt class="docutils literal"><span class="pre">keys()</span></tt>.</blockquote>
<p>itervalues()
__iter__()
values()</p>
<blockquote>
<p>Return an iterator over representations of all messages if
called as <tt class="docutils literal"><span class="pre">itervalues()</span></tt> or <tt class="docutils literal"><span class="pre">__iter__()</span></tt> or return a list of
such representations if called as <tt class="docutils literal"><span class="pre">values()</span></tt>. The messages are
represented as instances of the appropriate format-specific
<tt class="docutils literal"><span class="pre">Message</span></tt> subclass unless a custom message factory was
specified when the <tt class="docutils literal"><span class="pre">Mailbox</span></tt> instance was initialized.</p>
<dl class="docutils">
<dt>Note: The behavior of <tt class="docutils literal"><span class="pre">__iter__()</span></tt> is unlike that of dictionaries,</dt>
<dd>which iterate over keys.</dd>
</dl>
</blockquote>
<p>iteritems()
items()</p>
<blockquote>
Return an iterator over (<em>key</em>, <em>message</em>) pairs, where <em>key</em> is
a key and <em>message</em> is a message representation, if called as
<tt class="docutils literal"><span class="pre">iteritems()</span></tt> or return a list of such pairs if called as
<tt class="docutils literal"><span class="pre">items()</span></tt>. The messages are represented as instances of the
appropriate format-specific <tt class="docutils literal"><span class="pre">Message</span></tt> subclass unless a custom
message factory was specified when the <tt class="docutils literal"><span class="pre">Mailbox</span></tt> instance was
initialized.</blockquote>
<p>get(key[, default=None])
__getitem__(key)</p>
<blockquote>
Return a representation of the message corresponding to <em>key</em>.
If no such message exists, <em>default</em> is returned if the method
was called as <tt class="docutils literal"><span class="pre">get()</span></tt> and a <tt class="docutils literal"><span class="pre">KeyError</span></tt> exception is raised
if the method was called as <tt class="docutils literal"><span class="pre">__getitem__()</span></tt>. The message is
represented as an instance of the appropriate format-specific
<tt class="docutils literal"><span class="pre">Message</span></tt> subclass unless a custom message factory was
specified when the <tt class="docutils literal"><span class="pre">Mailbox</span></tt> instance was initialized.</blockquote>
<p>get_message(key)</p>
<blockquote>
Return a representation of the message corresponding to <em>key</em> as
an instance of the appropriate format-specific <tt class="docutils literal"><span class="pre">Message</span></tt>
subclass, or raise a <tt class="docutils literal"><span class="pre">KeyError</span></tt> exception if no such message
exists.</blockquote>
<p>get_string(key)</p>
<blockquote>
Return a string representation of the message corresponding to
<em>key</em>, or raise a <tt class="docutils literal"><span class="pre">KeyError</span></tt> exception if no such message
exists.</blockquote>
<p>get_file(key)</p>
<blockquote>
<p>Return a file-like representation of the message corresponding
to <em>key</em>, or raise a <tt class="docutils literal"><span class="pre">KeyError</span></tt> exception if no such message
exists. The file-like object behaves as if open in binary mode.
This file should be closed once it is no longer needed.</p>
<dl class="docutils">
<dt>Note: Unlike other representations of messages, file-like</dt>
<dd>representations are not necessarily independent of the
<tt class="docutils literal"><span class="pre">Mailbox</span></tt> instance that created them or of the underlying
mailbox. More specific documentation is provided by each
subclass.</dd>
</dl>
</blockquote>
<p>has_key(key)
__contains__(key)</p>
<blockquote>
Return <tt class="xref docutils literal"><span class="pre">True</span></tt> if <em>key</em> corresponds to a message, <tt class="xref docutils literal"><span class="pre">False</span></tt>
otherwise.</blockquote>
<p>__len__()</p>
<blockquote>
Return a count of messages in the mailbox.</blockquote>
<p>clear()</p>
<blockquote>
Delete all messages from the mailbox.</blockquote>
<p>pop(key[, default])</p>
<blockquote>
Return a representation of the message corresponding to <em>key</em>
and delete the message. If no such message exists, return
<em>default</em> if it was supplied or else raise a <tt class="docutils literal"><span class="pre">KeyError</span></tt>
exception. The message is represented as an instance of the
appropriate format-specific <tt class="docutils literal"><span class="pre">Message</span></tt> subclass unless a custom
message factory was specified when the <tt class="docutils literal"><span class="pre">Mailbox</span></tt> instance was
initialized.</blockquote>
<p>popitem()</p>
<blockquote>
Return an arbitrary (<em>key</em>, <em>message</em>) pair, where <em>key</em> is a
key and <em>message</em> is a message representation, and delete the
corresponding message. If the mailbox is empty, raise a
<tt class="docutils literal"><span class="pre">KeyError</span></tt> exception. The message is represented as an
instance of the appropriate format-specific <tt class="docutils literal"><span class="pre">Message</span></tt> subclass
unless a custom message factory was specified when the
<tt class="docutils literal"><span class="pre">Mailbox</span></tt> instance was initialized.</blockquote>
<p>update(arg)</p>
<blockquote>
<p>Parameter <em>arg</em> should be a <em>key</em>-to-<em>message</em> mapping or an
iterable of (<em>key</em>, <em>message</em>) pairs. Updates the mailbox so
that, for each given <em>key</em> and <em>message</em>, the message
corresponding to <em>key</em> is set to <em>message</em> as if by using
<tt class="docutils literal"><span class="pre">__setitem__()</span></tt>. As with <tt class="docutils literal"><span class="pre">__setitem__()</span></tt>, each <em>key</em> must
already correspond to a message in the mailbox or else a
<tt class="docutils literal"><span class="pre">KeyError</span></tt> exception will be raised, so in general it is
incorrect for <em>arg</em> to be a <tt class="docutils literal"><span class="pre">Mailbox</span></tt> instance.</p>
<p>Note: Unlike with dictionaries, keyword arguments are not supported.</p>
</blockquote>
<p>flush()</p>
<blockquote>
Write any pending changes to the filesystem. For some
<tt class="docutils literal"><span class="pre">Mailbox</span></tt> subclasses, changes are always written immediately
and <tt class="docutils literal"><span class="pre">flush()</span></tt> does nothing, but you should still make a habit
of calling this method.</blockquote>
<p>lock()</p>
<blockquote>
Acquire an exclusive advisory lock on the mailbox so that other
processes know not to modify it. An <tt class="docutils literal"><span class="pre">ExternalClashError</span></tt> is
raised if the lock is not available. The particular locking
mechanisms used depend upon the mailbox format.  You should
<em>always</em> lock the mailbox before making any modifications to its
contents.</blockquote>
<p>unlock()</p>
<blockquote>
Release the lock on the mailbox, if any.</blockquote>
<p>close()</p>
<blockquote>
Flush the mailbox, unlock it if necessary, and close any open
files. For some <tt class="docutils literal"><span class="pre">Mailbox</span></tt> subclasses, this method does
nothing.</blockquote>
</blockquote>
<div class="section" id="maildir">
<h3>18.3.1.1. <tt class="docutils literal"><span class="pre">Maildir</span></tt><a class="headerlink" href="#maildir" title="Permalink to this headline">¶</a></h3>
<p>class class mailbox.Maildir(dirname[, factory=rfc822.Message[, create=True]])</p>
<blockquote>
<p>A subclass of <tt class="docutils literal"><span class="pre">Mailbox</span></tt> for mailboxes in Maildir format.
Parameter <em>factory</em> is a callable object that accepts a file-like
message representation (which behaves as if opened in binary mode)
and returns a custom representation. If <em>factory</em> is <tt class="xref docutils literal"><span class="pre">None</span></tt>,
<tt class="docutils literal"><span class="pre">MaildirMessage</span></tt> is used as the default message representation.
If <em>create</em> is <tt class="xref docutils literal"><span class="pre">True</span></tt>, the mailbox is created if it does not
exist.</p>
<p>It is for historical reasons that <em>factory</em> defaults to
<tt class="docutils literal"><span class="pre">rfc822.Message</span></tt> and that <em>dirname</em> is named as such rather than
<em>path</em>. For a <tt class="docutils literal"><span class="pre">Maildir</span></tt> instance that behaves like instances of
other <tt class="docutils literal"><span class="pre">Mailbox</span></tt> subclasses, set <em>factory</em> to <tt class="xref docutils literal"><span class="pre">None</span></tt>.</p>
<p>Maildir is a directory-based mailbox format invented for the qmail
mail transfer agent and now widely supported by other programs.
Messages in a Maildir mailbox are stored in separate files within a
common directory structure. This design allows Maildir mailboxes to
be accessed and modified by multiple unrelated programs without
data corruption, so file locking is unnecessary.</p>
<p>Maildir mailboxes contain three subdirectories, namely: <tt class="docutils literal"><span class="pre">tmp</span></tt>,
<tt class="docutils literal"><span class="pre">new</span></tt>, and <tt class="docutils literal"><span class="pre">cur</span></tt>. Messages are created momentarily in the
<tt class="docutils literal"><span class="pre">tmp</span></tt> subdirectory and then moved to the <tt class="docutils literal"><span class="pre">new</span></tt> subdirectory to
finalize delivery. A mail user agent may subsequently move the
message to the <tt class="docutils literal"><span class="pre">cur</span></tt> subdirectory and store information about the
state of the message in a special &#8220;info&#8221; section appended to its
file name.</p>
<p>Folders of the style introduced by the Courier mail transfer agent
are also supported. Any subdirectory of the main mailbox is
considered a folder if <tt class="docutils literal"><span class="pre">'.'</span></tt> is the first character in its name.
Folder names are represented by <tt class="docutils literal"><span class="pre">Maildir</span></tt> without the leading
<tt class="docutils literal"><span class="pre">'.'</span></tt>. Each folder is itself a Maildir mailbox but should not
contain other folders. Instead, a logical nesting is indicated
using <tt class="docutils literal"><span class="pre">'.'</span></tt> to delimit levels, e.g., &#8220;Archived.2005.07&#8221;.</p>
<dl class="docutils">
<dt>Note: The Maildir specification requires the use of a colon (<tt class="docutils literal"><span class="pre">':'</span></tt>)</dt>
<dd><p class="first">in certain message file names. However, some operating systems do
not permit this character in file names, If you wish to use a
Maildir-like format on such an operating system, you should
specify another character to use instead. The exclamation point
(<tt class="docutils literal"><span class="pre">'!'</span></tt>) is a popular choice. For example:</p>
<blockquote>
import mailbox
mailbox.Maildir.colon = &#8216;!&#8217;</blockquote>
<p class="last">The <tt class="docutils literal"><span class="pre">colon</span></tt> attribute may also be set on a per-instance basis.</p>
</dd>
</dl>
<p><tt class="docutils literal"><span class="pre">Maildir</span></tt> instances have all of the methods of <tt class="docutils literal"><span class="pre">Mailbox</span></tt> in
addition to the following:</p>
<p>list_folders()</p>
<blockquote>
Return a list of the names of all folders.</blockquote>
<p>.et_folder(folder)</p>
<blockquote>
Return a <tt class="docutils literal"><span class="pre">Maildir</span></tt> instance representing the folder whose name
is <em>folder</em>. A <tt class="docutils literal"><span class="pre">NoSuchMailboxError</span></tt> exception is raised if the
folder does not exist.</blockquote>
<p>add_folder(folder)</p>
<blockquote>
Create a folder whose name is <em>folder</em> and return a <tt class="docutils literal"><span class="pre">Maildir</span></tt>
instance representing it.</blockquote>
<p>remove_folder(folder)</p>
<blockquote>
Delete the folder whose name is <em>folder</em>. If the folder contains
any messages, a <tt class="docutils literal"><span class="pre">NotEmptyError</span></tt> exception will be raised and
the folder will not be deleted.</blockquote>
<p>clean()</p>
<blockquote>
Delete temporary files from the mailbox that have not been
accessed in the last 36 hours. The Maildir specification says
that mail-reading programs should do this occasionally.</blockquote>
<p>Some <tt class="docutils literal"><span class="pre">Mailbox</span></tt> methods implemented by <tt class="docutils literal"><span class="pre">Maildir</span></tt> deserve special
remarks:</p>
<p>add(message)
__setitem__(key, message)
update(arg)</p>
<blockquote>
<dl class="docutils">
<dt>Warning: These methods generate unique file names based upon the</dt>
<dd>current process ID. When using multiple threads, undetected
name clashes may occur and cause corruption of the mailbox
unless threads are coordinated to avoid using these methods to
manipulate the same mailbox simultaneously.</dd>
</dl>
</blockquote>
<p>flush()</p>
<blockquote>
All changes to Maildir mailboxes are immediately applied, so
this method does nothing.</blockquote>
<p>lock()
unlock()</p>
<blockquote>
Maildir mailboxes do not support (or require) locking, so these
methods do nothing.</blockquote>
<p>close()</p>
<blockquote>
<tt class="docutils literal"><span class="pre">Maildir</span></tt> instances do not keep any open files and the
underlying mailboxes do not support locking, so this method does
nothing.</blockquote>
<p>get_file(key)</p>
<blockquote>
Depending upon the host platform, it may not be possible to
modify or remove the underlying message while the returned file
remains open.</blockquote>
</blockquote>
<p>See also:</p>
<blockquote>
<dl class="docutils">
<dt>maildir man page from qmail</dt>
<dd>The original specification of the format.</dd>
<dt>Using maildir format</dt>
<dd>Notes on Maildir by its inventor. Includes an updated name-
creation scheme and details on &#8220;info&#8221; semantics.</dd>
<dt>maildir man page from Courier</dt>
<dd>Another specification of the format. Describes a common
extension for supporting folders.</dd>
</dl>
</blockquote>
</div>
<div class="section" id="mbox">
<h3>18.3.1.2. <tt class="docutils literal"><span class="pre">mbox</span></tt><a class="headerlink" href="#mbox" title="Permalink to this headline">¶</a></h3>
<p>class class mailbox.mbox(path[, factory=None[, create=True]])</p>
<blockquote>
<p>A subclass of <tt class="docutils literal"><span class="pre">Mailbox</span></tt> for mailboxes in mbox format. Parameter
<em>factory</em> is a callable object that accepts a file-like message
representation (which behaves as if opened in binary mode) and
returns a custom representation. If <em>factory</em> is <tt class="xref docutils literal"><span class="pre">None</span></tt>,
<tt class="docutils literal"><span class="pre">mboxMessage</span></tt> is used as the default message representation. If
<em>create</em> is <tt class="xref docutils literal"><span class="pre">True</span></tt>, the mailbox is created if it does not exist.</p>
<p>The mbox format is the classic format for storing mail on Unix
systems. All messages in an mbox mailbox are stored in a single
file with the beginning of each message indicated by a line whose
first five characters are &#8220;From &#8220;.</p>
<p>Several variations of the mbox format exist to address perceived
shortcomings in the original. In the interest of compatibility,
<tt class="docutils literal"><span class="pre">mbox</span></tt> implements the original format, which is sometimes
referred to as <em>mboxo</em>. This means that the <em>Content-Length</em>
header, if present, is ignored and that any occurrences of &#8220;From &#8221;
at the beginning of a line in a message body are transformed to
&#8220;&gt;From &#8221; when storing the message, although occurrences of &#8220;&gt;From &#8221;
are not transformed to &#8220;From &#8221; when reading the message.</p>
<p>Some <tt class="docutils literal"><span class="pre">Mailbox</span></tt> methods implemented by <tt class="docutils literal"><span class="pre">mbox</span></tt> deserve special
remarks:</p>
<p>get_file(key)</p>
<blockquote>
Using the file after calling <tt class="docutils literal"><span class="pre">flush()</span></tt> or <tt class="docutils literal"><span class="pre">close()</span></tt> on the
<tt class="docutils literal"><span class="pre">mbox</span></tt> instance may yield unpredictable results or raise an
exception.</blockquote>
<p>lock()
unlock()</p>
<blockquote>
Three locking mechanisms are used&#8212;dot locking and, if
available, the <tt class="docutils literal"><span class="pre">flock()</span></tt> and <tt class="docutils literal"><span class="pre">lockf()</span></tt> system calls.</blockquote>
</blockquote>
<p>See also:</p>
<blockquote>
<dl class="docutils">
<dt>mbox man page from qmail</dt>
<dd>A specification of the format and its variations.</dd>
<dt>mbox man page from tin</dt>
<dd>Another specification of the format, with details on locking.</dd>
</dl>
<p>Configuring Netscape Mail on Unix: Why The Content-Length Format is
Bad</p>
<blockquote>
An argument for using the original mbox format rather than a
variation.</blockquote>
<dl class="docutils">
<dt>&#8220;mbox&#8221; is a family of several mutually incompatible mailbox formats</dt>
<dd>A history of mbox variations.</dd>
</dl>
</blockquote>
</div>
<div class="section" id="mh">
<h3>18.3.1.3. <tt class="docutils literal"><span class="pre">MH</span></tt><a class="headerlink" href="#mh" title="Permalink to this headline">¶</a></h3>
<p>class class mailbox.MH(path[, factory=None[, create=True]])</p>
<blockquote>
<p>A subclass of <tt class="docutils literal"><span class="pre">Mailbox</span></tt> for mailboxes in MH format. Parameter
<em>factory</em> is a callable object that accepts a file-like message
representation (which behaves as if opened in binary mode) and
returns a custom representation. If <em>factory</em> is <tt class="xref docutils literal"><span class="pre">None</span></tt>,
<tt class="docutils literal"><span class="pre">MHMessage</span></tt> is used as the default message representation. If
<em>create</em> is <tt class="xref docutils literal"><span class="pre">True</span></tt>, the mailbox is created if it does not exist.</p>
<p>MH is a directory-based mailbox format invented for the MH Message
Handling System, a mail user agent. Each message in an MH mailbox
resides in its own file. An MH mailbox may contain other MH
mailboxes (called <em>folders</em>) in addition to messages. Folders may
be nested indefinitely. MH mailboxes also support <em>sequences</em>,
which are named lists used to logically group messages without
moving them to sub-folders. Sequences are defined in a file called
<tt class="docutils literal"><span class="pre">.mh_sequences</span></tt> in each folder.</p>
<p>The <tt class="docutils literal"><span class="pre">MH</span></tt> class manipulates MH mailboxes, but it does not attempt
to emulate all of <strong>mh</strong>&#8216;s behaviors. In particular, it does not
modify and is not affected by the <tt class="docutils literal"><span class="pre">context</span></tt> or <tt class="docutils literal"><span class="pre">.mh_profile</span></tt>
files that are used by <strong>mh</strong> to store its state and configuration.</p>
<p><tt class="docutils literal"><span class="pre">MH</span></tt> instances have all of the methods of <tt class="docutils literal"><span class="pre">Mailbox</span></tt> in addition
to the following:</p>
<p>list_folders()</p>
<blockquote>
Return a list of the names of all folders.</blockquote>
<p>get_folder(folder)</p>
<blockquote>
Return an <tt class="docutils literal"><span class="pre">MH</span></tt> instance representing the folder whose name is
<em>folder</em>. A <tt class="docutils literal"><span class="pre">NoSuchMailboxError</span></tt> exception is raised if the
folder does not exist.</blockquote>
<p>add_folder(folder)</p>
<blockquote>
Create a folder whose name is <em>folder</em> and return an <tt class="docutils literal"><span class="pre">MH</span></tt>
instance representing it.</blockquote>
<p>remove_folder(folder)</p>
<blockquote>
Delete the folder whose name is <em>folder</em>. If the folder contains
any messages, a <tt class="docutils literal"><span class="pre">NotEmptyError</span></tt> exception will be raised and
the folder will not be deleted.</blockquote>
<p>get_sequences()</p>
<blockquote>
Return a dictionary of sequence names mapped to key lists. If
there are no sequences, the empty dictionary is returned.</blockquote>
<p>set_sequences(sequences)</p>
<blockquote>
Re-define the sequences that exist in the mailbox based upon
<em>sequences</em>, a dictionary of names mapped to key lists, like
returned by <tt class="docutils literal"><span class="pre">get_sequences()</span></tt>.</blockquote>
<p>pack()</p>
<blockquote>
<p>Rename messages in the mailbox as necessary to eliminate gaps in
numbering.  Entries in the sequences list are updated
correspondingly.</p>
<dl class="docutils">
<dt>Note: Already-issued keys are invalidated by this operation and</dt>
<dd>should not be subsequently used.</dd>
</dl>
</blockquote>
<p>Some <tt class="docutils literal"><span class="pre">Mailbox</span></tt> methods implemented by <tt class="docutils literal"><span class="pre">MH</span></tt> deserve special
remarks:</p>
<p>remove(key)
__delitem__(key)
discard(key)</p>
<blockquote>
These methods immediately delete the message. The MH convention
of marking a message for deletion by prepending a comma to its
name is not used.</blockquote>
<p>lock()
unlock()</p>
<blockquote>
Three locking mechanisms are used&#8212;dot locking and, if
available, the <tt class="docutils literal"><span class="pre">flock()</span></tt> and <tt class="docutils literal"><span class="pre">lockf()</span></tt> system calls. For MH
mailboxes, locking the mailbox means locking the
<tt class="docutils literal"><span class="pre">.mh_sequences</span></tt> file and, only for the duration of any
operations that affect them, locking individual message files.</blockquote>
<p>get_file(key)</p>
<blockquote>
Depending upon the host platform, it may not be possible to
remove the underlying message while the returned file remains
open.</blockquote>
<p>flush()</p>
<blockquote>
All changes to MH mailboxes are immediately applied, so this
method does nothing.</blockquote>
<p>close()</p>
<blockquote>
<tt class="docutils literal"><span class="pre">MH</span></tt> instances do not keep any open files, so this method is
equivalent to <tt class="docutils literal"><span class="pre">unlock()</span></tt>.</blockquote>
</blockquote>
<p>See also:</p>
<blockquote>
<dl class="docutils">
<dt>nmh - Message Handling System</dt>
<dd>Home page of <strong>nmh</strong>, an updated version of the original <strong>mh</strong>.</dd>
<dt>MH &amp; nmh: Email for Users &amp; Programmers</dt>
<dd>A GPL-licensed book on <strong>mh</strong> and <strong>nmh</strong>, with some information
on the mailbox format.</dd>
</dl>
</blockquote>
</div>
<div class="section" id="babyl">
<h3>18.3.1.4. <tt class="docutils literal"><span class="pre">Babyl</span></tt><a class="headerlink" href="#babyl" title="Permalink to this headline">¶</a></h3>
<p>class class mailbox.Babyl(path[, factory=None[, create=True]])</p>
<blockquote>
<p>A subclass of <tt class="docutils literal"><span class="pre">Mailbox</span></tt> for mailboxes in Babyl format. Parameter
<em>factory</em> is a callable object that accepts a file-like message
representation (which behaves as if opened in binary mode) and
returns a custom representation. If <em>factory</em> is <tt class="xref docutils literal"><span class="pre">None</span></tt>,
<tt class="docutils literal"><span class="pre">BabylMessage</span></tt> is used as the default message representation. If
<em>create</em> is <tt class="xref docutils literal"><span class="pre">True</span></tt>, the mailbox is created if it does not exist.</p>
<p>Babyl is a single-file mailbox format used by the Rmail mail user
agent included with Emacs. The beginning of a message is indicated
by a line containing the two characters Control-Underscore
(<tt class="docutils literal"><span class="pre">'\037'</span></tt>) and Control-L (<tt class="docutils literal"><span class="pre">'\014'</span></tt>). The end of a message is
indicated by the start of the next message or, in the case of the
last message, a line containing a Control-Underscore (<tt class="docutils literal"><span class="pre">'\037'</span></tt>)
character.</p>
<p>Messages in a Babyl mailbox have two sets of headers, original
headers and so-called visible headers. Visible headers are
typically a subset of the original headers that have been
reformatted or abridged to be more attractive. Each message in a
Babyl mailbox also has an accompanying list of <em>labels</em>, or short
strings that record extra information about the message, and a list
of all user-defined labels found in the mailbox is kept in the
Babyl options section.</p>
<p><tt class="docutils literal"><span class="pre">Babyl</span></tt> instances have all of the methods of <tt class="docutils literal"><span class="pre">Mailbox</span></tt> in
addition to the following:</p>
<p>get_labels()</p>
<blockquote>
<p>Return a list of the names of all user-defined labels used in
the mailbox.</p>
<dl class="docutils">
<dt>Note: The actual messages are inspected to determine which labels</dt>
<dd>exist in the mailbox rather than consulting the list of labels
in the Babyl options section, but the Babyl section is updated
whenever the mailbox is modified.</dd>
</dl>
</blockquote>
<p>Some <tt class="docutils literal"><span class="pre">Mailbox</span></tt> methods implemented by <tt class="docutils literal"><span class="pre">Babyl</span></tt> deserve special
remarks:</p>
<p>get_file(key)</p>
<blockquote>
In Babyl mailboxes, the headers of a message are not stored
contiguously with the body of the message. To generate a file-
like representation, the headers and body are copied together
into a <tt class="docutils literal"><span class="pre">StringIO</span></tt> instance (from the <tt class="docutils literal"><span class="pre">StringIO</span></tt> module),
which has an API identical to that of a file. As a result, the
file-like object is truly independent of the underlying mailbox
but does not save memory compared to a string representation.</blockquote>
<p>lock()
unlock()</p>
<blockquote>
Three locking mechanisms are used&#8212;dot locking and, if
available, the <tt class="docutils literal"><span class="pre">flock()</span></tt> and <tt class="docutils literal"><span class="pre">lockf()</span></tt> system calls.</blockquote>
</blockquote>
<p>See also:</p>
<blockquote>
<dl class="docutils">
<dt>Format of Version 5 Babyl Files</dt>
<dd>A specification of the Babyl format.</dd>
<dt>Reading Mail with Rmail</dt>
<dd>The Rmail manual, with some information on Babyl semantics.</dd>
</dl>
</blockquote>
</div>
<div class="section" id="mmdf">
<h3>18.3.1.5. <tt class="docutils literal"><span class="pre">MMDF</span></tt><a class="headerlink" href="#mmdf" title="Permalink to this headline">¶</a></h3>
<p>class class mailbox.MMDF(path[, factory=None[, create=True]])</p>
<blockquote>
<p>A subclass of <tt class="docutils literal"><span class="pre">Mailbox</span></tt> for mailboxes in MMDF format. Parameter
<em>factory</em> is a callable object that accepts a file-like message
representation (which behaves as if opened in binary mode) and
returns a custom representation. If <em>factory</em> is <tt class="xref docutils literal"><span class="pre">None</span></tt>,
<tt class="docutils literal"><span class="pre">MMDFMessage</span></tt> is used as the default message representation. If
<em>create</em> is <tt class="xref docutils literal"><span class="pre">True</span></tt>, the mailbox is created if it does not exist.</p>
<p>MMDF is a single-file mailbox format invented for the Multichannel
Memorandum Distribution Facility, a mail transfer agent. Each
message is in the same form as an mbox message but is bracketed
before and after by lines containing four Control-A (<tt class="docutils literal"><span class="pre">'\001'</span></tt>)
characters. As with the mbox format, the beginning of each message
is indicated by a line whose first five characters are &#8220;From &#8220;, but
additional occurrences of &#8220;From &#8221; are not transformed to &#8220;&gt;From &#8221;
when storing messages because the extra message separator lines
prevent mistaking such occurrences for the starts of subsequent
messages.</p>
<p>Some <tt class="docutils literal"><span class="pre">Mailbox</span></tt> methods implemented by <tt class="docutils literal"><span class="pre">MMDF</span></tt> deserve special
remarks:</p>
<p>get_file(key)</p>
<blockquote>
Using the file after calling <tt class="docutils literal"><span class="pre">flush()</span></tt> or <tt class="docutils literal"><span class="pre">close()</span></tt> on the
<tt class="docutils literal"><span class="pre">MMDF</span></tt> instance may yield unpredictable results or raise an
exception.</blockquote>
<p>lock()
unlock()</p>
<blockquote>
Three locking mechanisms are used&#8212;dot locking and, if
available, the <tt class="docutils literal"><span class="pre">flock()</span></tt> and <tt class="docutils literal"><span class="pre">lockf()</span></tt> system calls.</blockquote>
</blockquote>
<p>See also:</p>
<blockquote>
<dl class="docutils">
<dt>mmdf man page from tin</dt>
<dd>A specification of MMDF format from the documentation of tin, a
newsreader.</dd>
<dt>MMDF</dt>
<dd>A Wikipedia article describing the Multichannel Memorandum
Distribution Facility.</dd>
</dl>
</blockquote>
</div>
</div>
<div class="section" id="message-objects">
<h2>18.3.2. <tt class="docutils literal"><span class="pre">Message</span></tt> objects<a class="headerlink" href="#message-objects" title="Permalink to this headline">¶</a></h2>
<p>class class mailbox.Message([message])</p>
<blockquote>
<p>A subclass of the <tt class="docutils literal"><span class="pre">email.Message</span></tt> module&#8217;s <tt class="docutils literal"><span class="pre">Message</span></tt>.
Subclasses of <tt class="docutils literal"><span class="pre">mailbox.Message</span></tt> add mailbox-format-specific state
and behavior.</p>
<p>If <em>message</em> is omitted, the new instance is created in a default,
empty state. If <em>message</em> is an <tt class="docutils literal"><span class="pre">email.Message.Message</span></tt> instance,
its contents are copied; furthermore, any format-specific
information is converted insofar as possible if <em>message</em> is a
<tt class="docutils literal"><span class="pre">Message</span></tt> instance. If <em>message</em> is a string or a file, it should
contain an <strong>RFC 2822</strong>-compliant message, which is read and
parsed.</p>
<p>The format-specific state and behaviors offered by subclasses vary,
but in general it is only the properties that are not specific to a
particular mailbox that are supported (although presumably the
properties are specific to a particular mailbox format). For
example, file offsets for single-file mailbox formats and file
names for directory-based mailbox formats are not retained, because
they are only applicable to the original mailbox. But state such as
whether a message has been read by the user or marked as important
is retained, because it applies to the message itself.</p>
<p>There is no requirement that <tt class="docutils literal"><span class="pre">Message</span></tt> instances be used to
represent messages retrieved using <tt class="docutils literal"><span class="pre">Mailbox</span></tt> instances. In some
situations, the time and memory required to generate <tt class="docutils literal"><span class="pre">Message</span></tt>
representations might not not acceptable. For such situations,
<tt class="docutils literal"><span class="pre">Mailbox</span></tt> instances also offer string and file-like
representations, and a custom message factory may be specified when
a <tt class="docutils literal"><span class="pre">Mailbox</span></tt> instance is initialized.</p>
</blockquote>
<div class="section" id="maildirmessage">
<h3>18.3.2.1. <tt class="docutils literal"><span class="pre">MaildirMessage</span></tt><a class="headerlink" href="#maildirmessage" title="Permalink to this headline">¶</a></h3>
<p>class class mailbox.MaildirMessage([message])</p>
<blockquote>
<p>A message with Maildir-specific behaviors. Parameter <em>message</em> has
the same meaning as with the <tt class="docutils literal"><span class="pre">Message</span></tt> constructor.</p>
<p>Typically, a mail user agent application moves all of the messages
in the <tt class="docutils literal"><span class="pre">new</span></tt> subdirectory to the <tt class="docutils literal"><span class="pre">cur</span></tt> subdirectory after the
first time the user opens and closes the mailbox, recording that
the messages are old whether or not they&#8217;ve actually been read.
Each message in <tt class="docutils literal"><span class="pre">cur</span></tt> has an &#8220;info&#8221; section added to its file
name to store information about its state. (Some mail readers may
also add an &#8220;info&#8221; section to messages in <tt class="docutils literal"><span class="pre">new</span></tt>.)  The &#8220;info&#8221;
section may take one of two forms: it may contain &#8220;2,&#8221; followed by
a list of standardized flags (e.g., &#8220;2,FR&#8221;) or it may contain &#8220;1,&#8221;
followed by so-called experimental information. Standard flags for
Maildir messages are as follows:</p>
<table border="1" class="docutils">
<colgroup>
<col width="15%" />
<col width="21%" />
<col width="64%" />
</colgroup>
<thead valign="bottom">
<tr><th class="head">Flag</th>
<th class="head">Meaning</th>
<th class="head">Explanation</th>
</tr>
</thead>
<tbody valign="top">
<tr><td>D</td>
<td>Draft</td>
<td>Under composition</td>
</tr>
<tr><td>F</td>
<td>Flagged</td>
<td>Marked as important</td>
</tr>
<tr><td>P</td>
<td>Passed</td>
<td>Forwarded, resent, or bounced</td>
</tr>
<tr><td>R</td>
<td>Replied</td>
<td>Replied to</td>
</tr>
<tr><td>S</td>
<td>Seen</td>
<td>Read</td>
</tr>
<tr><td>T</td>
<td>Trashed</td>
<td>Marked for subsequent deletion</td>
</tr>
</tbody>
</table>
<p><tt class="docutils literal"><span class="pre">MaildirMessage</span></tt> instances offer the following methods:</p>
<p>get_subdir()</p>
<blockquote>
<p>Return either &#8220;new&#8221; (if the message should be stored in the
<tt class="docutils literal"><span class="pre">new</span></tt> subdirectory) or &#8220;cur&#8221; (if the message should be stored
in the <tt class="docutils literal"><span class="pre">cur</span></tt> subdirectory).</p>
<dl class="docutils">
<dt>Note: A message is typically moved from <tt class="docutils literal"><span class="pre">new</span></tt> to <tt class="docutils literal"><span class="pre">cur</span></tt> after its</dt>
<dd>mailbox has been accessed, whether or not the message is has
been read. A message <tt class="docutils literal"><span class="pre">msg</span></tt> has been read if <tt class="docutils literal"><span class="pre">&quot;S&quot;</span> <span class="pre">in</span>
<span class="pre">msg.get_flags()</span></tt> is <tt class="xref docutils literal"><span class="pre">True</span></tt>.</dd>
</dl>
</blockquote>
<p>set_subdir(subdir)</p>
<blockquote>
Set the subdirectory the message should be stored in. Parameter
<em>subdir</em> must be either &#8220;new&#8221; or &#8220;cur&#8221;.</blockquote>
<p>get_flags()</p>
<blockquote>
Return a string specifying the flags that are currently set. If
the message complies with the standard Maildir format, the
result is the concatenation in alphabetical order of zero or one
occurrence of each of <tt class="docutils literal"><span class="pre">'D'</span></tt>, <tt class="docutils literal"><span class="pre">'F'</span></tt>, <tt class="docutils literal"><span class="pre">'P'</span></tt>, <tt class="docutils literal"><span class="pre">'R'</span></tt>,
<tt class="docutils literal"><span class="pre">'S'</span></tt>, and <tt class="docutils literal"><span class="pre">'T'</span></tt>. The empty string is returned if no flags
are set or if &#8220;info&#8221; contains experimental semantics.</blockquote>
<p>set_flags(flags)</p>
<blockquote>
Set the flags specified by <em>flags</em> and unset all others.</blockquote>
<p>add_flag(flag)</p>
<blockquote>
Set the flag(s) specified by <em>flag</em> without changing other
flags. To add more than one flag at a time, <em>flag</em> may be a
string of more than one character. The current &#8220;info&#8221; is
overwritten whether or not it contains experimental information
rather than flags.</blockquote>
<p>remove_flag(flag)</p>
<blockquote>
Unset the flag(s) specified by <em>flag</em> without changing other
flags. To remove more than one flag at a time, <em>flag</em> maybe a
string of more than one character.  If &#8220;info&#8221; contains
experimental information rather than flags, the current &#8220;info&#8221;
is not modified.</blockquote>
<p>get_date()</p>
<blockquote>
Return the delivery date of the message as a floating-point
number representing seconds since the epoch.</blockquote>
<p>set_date(date)</p>
<blockquote>
Set the delivery date of the message to <em>date</em>, a floating-point
number representing seconds since the epoch.</blockquote>
<p>get_info()</p>
<blockquote>
Return a string containing the &#8220;info&#8221; for a message. This is
useful for accessing and modifying &#8220;info&#8221; that is experimental
(i.e., not a list of flags).</blockquote>
<p>set_info(info)</p>
<blockquote>
Set &#8220;info&#8221; to <em>info</em>, which should be a string.</blockquote>
</blockquote>
<p>When a <tt class="docutils literal"><span class="pre">MaildirMessage</span></tt> instance is created based upon an
<tt class="docutils literal"><span class="pre">mboxMessage</span></tt> or <tt class="docutils literal"><span class="pre">MMDFMessage</span></tt> instance, the <em>Status</em> and
<em>X-Status</em> headers are omitted and the following conversions take
place:</p>
<table border="1" class="docutils">
<colgroup>
<col width="31%" />
<col width="69%" />
</colgroup>
<thead valign="bottom">
<tr><th class="head">Resulting state</th>
<th class="head"><tt class="docutils literal"><span class="pre">mboxMessage</span></tt> or <tt class="docutils literal"><span class="pre">MMDFMessage</span></tt> state</th>
</tr>
</thead>
<tbody valign="top">
<tr><td>&#8220;cur&#8221; subdirectory</td>
<td>O flag</td>
</tr>
<tr><td>F flag</td>
<td>F flag</td>
</tr>
<tr><td>R flag</td>
<td>A flag</td>
</tr>
<tr><td>S flag</td>
<td>R flag</td>
</tr>
<tr><td>T flag</td>
<td>D flag</td>
</tr>
</tbody>
</table>
<p>When a <tt class="docutils literal"><span class="pre">MaildirMessage</span></tt> instance is created based upon an
<tt class="docutils literal"><span class="pre">MHMessage</span></tt> instance, the following conversions take place:</p>
<table border="1" class="docutils">
<colgroup>
<col width="54%" />
<col width="46%" />
</colgroup>
<thead valign="bottom">
<tr><th class="head">Resulting state</th>
<th class="head"><tt class="docutils literal"><span class="pre">MHMessage</span></tt> state</th>
</tr>
</thead>
<tbody valign="top">
<tr><td>&#8220;cur&#8221; subdirectory</td>
<td>&#8220;unseen&#8221; sequence</td>
</tr>
<tr><td>&#8220;cur&#8221; subdirectory and S flag</td>
<td>no &#8220;unseen&#8221; sequence</td>
</tr>
<tr><td>F flag</td>
<td>&#8220;flagged&#8221; sequence</td>
</tr>
<tr><td>R flag</td>
<td>&#8220;replied&#8221; sequence</td>
</tr>
</tbody>
</table>
<p>When a <tt class="docutils literal"><span class="pre">MaildirMessage</span></tt> instance is created based upon a
<tt class="docutils literal"><span class="pre">BabylMessage</span></tt> instance, the following conversions take place:</p>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr><th class="head">Resulting state</th>
<th class="head"><tt class="docutils literal"><span class="pre">BabylMessage</span></tt> state</th>
</tr>
</thead>
<tbody valign="top">
<tr><td>&#8220;cur&#8221; subdirectory</td>
<td>&#8220;unseen&#8221; label</td>
</tr>
<tr><td>&#8220;cur&#8221; subdirectory and S flag</td>
<td>no &#8220;unseen&#8221; label</td>
</tr>
<tr><td>P flag</td>
<td>&#8220;forwarded&#8221; or &#8220;resent&#8221; label</td>
</tr>
<tr><td>R flag</td>
<td>&#8220;answered&#8221; label</td>
</tr>
<tr><td>T flag</td>
<td>&#8220;deleted&#8221; label</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="mboxmessage">
<h3>18.3.2.2. <tt class="docutils literal"><span class="pre">mboxMessage</span></tt><a class="headerlink" href="#mboxmessage" title="Permalink to this headline">¶</a></h3>
<p>class class mailbox.mboxMessage([message])</p>
<blockquote>
<p>A message with mbox-specific behaviors. Parameter <em>message</em> has the
same meaning as with the <tt class="docutils literal"><span class="pre">Message</span></tt> constructor.</p>
<p>Messages in an mbox mailbox are stored together in a single file.
The sender&#8217;s envelope address and the time of delivery are
typically stored in a line beginning with &#8220;From &#8221; that is used to
indicate the start of a message, though there is considerable
variation in the exact format of this data among mbox
implementations. Flags that indicate the state of the message, such
as whether it has been read or marked as important, are typically
stored in <em>Status</em> and <em>X-Status</em> headers.</p>
<p>Conventional flags for mbox messages are as follows:</p>
<table border="1" class="docutils">
<colgroup>
<col width="15%" />
<col width="22%" />
<col width="63%" />
</colgroup>
<thead valign="bottom">
<tr><th class="head">Flag</th>
<th class="head">Meaning</th>
<th class="head">Explanation</th>
</tr>
</thead>
<tbody valign="top">
<tr><td>R</td>
<td>Read</td>
<td>Read</td>
</tr>
<tr><td>O</td>
<td>Old</td>
<td>Previously detected by MUA</td>
</tr>
<tr><td>D</td>
<td>Deleted</td>
<td>Marked for subsequent deletion</td>
</tr>
<tr><td>F</td>
<td>Flagged</td>
<td>Marked as important</td>
</tr>
<tr><td>A</td>
<td>Answered</td>
<td>Replied to</td>
</tr>
</tbody>
</table>
<p>The &#8220;R&#8221; and &#8220;O&#8221; flags are stored in the <em>Status</em> header, and the
&#8220;D&#8221;, &#8220;F&#8221;, and &#8220;A&#8221; flags are stored in the <em>X-Status</em> header. The
flags and headers typically appear in the order mentioned.</p>
<p><tt class="docutils literal"><span class="pre">mboxMessage</span></tt> instances offer the following methods:</p>
<p>get_from()</p>
<blockquote>
Return a string representing the &#8220;From &#8221; line that marks the
start of the message in an mbox mailbox. The leading &#8220;From &#8221; and
the trailing newline are excluded.</blockquote>
<p>set_from(from_[, time_=None])</p>
<blockquote>
Set the &#8220;From &#8221; line to <em>from_</em>, which should be specified
without a leading &#8220;From &#8221; or trailing newline. For convenience,
<em>time_</em> may be specified and will be formatted appropriately and
appended to <em>from_</em>. If <em>time_</em> is specified, it should be a
<tt class="docutils literal"><span class="pre">struct_time</span></tt> instance, a tuple suitable for passing to
<tt class="docutils literal"><span class="pre">time.strftime()</span></tt>, or <tt class="xref docutils literal"><span class="pre">True</span></tt> (to use <tt class="docutils literal"><span class="pre">time.gmtime()</span></tt>).</blockquote>
<p>get_flags()</p>
<blockquote>
Return a string specifying the flags that are currently set. If
the message complies with the conventional format, the result is
the concatenation in the following order of zero or one
occurrence of each of <tt class="docutils literal"><span class="pre">'R'</span></tt>, <tt class="docutils literal"><span class="pre">'O'</span></tt>, <tt class="docutils literal"><span class="pre">'D'</span></tt>, <tt class="docutils literal"><span class="pre">'F'</span></tt>, and
<tt class="docutils literal"><span class="pre">'A'</span></tt>.</blockquote>
<p>set_flags(flags)</p>
<blockquote>
Set the flags specified by <em>flags</em> and unset all others.
Parameter <em>flags</em> should be the concatenation in any order of
zero or more occurrences of each of <tt class="docutils literal"><span class="pre">'R'</span></tt>, <tt class="docutils literal"><span class="pre">'O'</span></tt>, <tt class="docutils literal"><span class="pre">'D'</span></tt>,
<tt class="docutils literal"><span class="pre">'F'</span></tt>, and <tt class="docutils literal"><span class="pre">'A'</span></tt>.</blockquote>
<p>add_flag(flag)</p>
<blockquote>
Set the flag(s) specified by <em>flag</em> without changing other
flags. To add more than one flag at a time, <em>flag</em> may be a
string of more than one character.</blockquote>
<p>remove_flag(flag)</p>
<blockquote>
Unset the flag(s) specified by <em>flag</em> without changing other
flags. To remove more than one flag at a time, <em>flag</em> maybe a
string of more than one character.</blockquote>
</blockquote>
<p>When an <tt class="docutils literal"><span class="pre">mboxMessage</span></tt> instance is created based upon a
<tt class="docutils literal"><span class="pre">MaildirMessage</span></tt> instance, a &#8220;From &#8221; line is generated based upon
the <tt class="docutils literal"><span class="pre">MaildirMessage</span></tt> instance&#8217;s delivery date, and the following
conversions take place:</p>
<table border="1" class="docutils">
<colgroup>
<col width="37%" />
<col width="63%" />
</colgroup>
<thead valign="bottom">
<tr><th class="head">Resulting state</th>
<th class="head"><tt class="docutils literal"><span class="pre">MaildirMessage</span></tt> state</th>
</tr>
</thead>
<tbody valign="top">
<tr><td>R flag</td>
<td>S flag</td>
</tr>
<tr><td>O flag</td>
<td>&#8220;cur&#8221; subdirectory</td>
</tr>
<tr><td>D flag</td>
<td>T flag</td>
</tr>
<tr><td>F flag</td>
<td>F flag</td>
</tr>
<tr><td>A flag</td>
<td>R flag</td>
</tr>
</tbody>
</table>
<p>When an <tt class="docutils literal"><span class="pre">mboxMessage</span></tt> instance is created based upon an
<tt class="docutils literal"><span class="pre">MHMessage</span></tt> instance, the following conversions take place:</p>
<table border="1" class="docutils">
<colgroup>
<col width="43%" />
<col width="57%" />
</colgroup>
<thead valign="bottom">
<tr><th class="head">Resulting state</th>
<th class="head"><tt class="docutils literal"><span class="pre">MHMessage</span></tt> state</th>
</tr>
</thead>
<tbody valign="top">
<tr><td>R flag and O flag</td>
<td>no &#8220;unseen&#8221; sequence</td>
</tr>
<tr><td>O flag</td>
<td>&#8220;unseen&#8221; sequence</td>
</tr>
<tr><td>F flag</td>
<td>&#8220;flagged&#8221; sequence</td>
</tr>
<tr><td>A flag</td>
<td>&#8220;replied&#8221; sequence</td>
</tr>
</tbody>
</table>
<p>When an <tt class="docutils literal"><span class="pre">mboxMessage</span></tt> instance is created based upon a
<tt class="docutils literal"><span class="pre">BabylMessage</span></tt> instance, the following conversions take place:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr><th class="head">Resulting state</th>
<th class="head"><tt class="docutils literal"><span class="pre">BabylMessage</span></tt> state</th>
</tr>
</thead>
<tbody valign="top">
<tr><td>R flag and O flag</td>
<td>no &#8220;unseen&#8221; label</td>
</tr>
<tr><td>O flag</td>
<td>&#8220;unseen&#8221; label</td>
</tr>
<tr><td>D flag</td>
<td>&#8220;deleted&#8221; label</td>
</tr>
<tr><td>A flag</td>
<td>&#8220;answered&#8221; label</td>
</tr>
</tbody>
</table>
<p>When a <tt class="docutils literal"><span class="pre">Message</span></tt> instance is created based upon an <tt class="docutils literal"><span class="pre">MMDFMessage</span></tt>
instance, the &#8220;From &#8221; line is copied and all flags directly
correspond:</p>
<table border="1" class="docutils">
<colgroup>
<col width="39%" />
<col width="61%" />
</colgroup>
<thead valign="bottom">
<tr><th class="head">Resulting state</th>
<th class="head"><tt class="docutils literal"><span class="pre">MMDFMessage</span></tt> state</th>
</tr>
</thead>
<tbody valign="top">
<tr><td>R flag</td>
<td>R flag</td>
</tr>
<tr><td>O flag</td>
<td>O flag</td>
</tr>
<tr><td>D flag</td>
<td>D flag</td>
</tr>
<tr><td>F flag</td>
<td>F flag</td>
</tr>
<tr><td>A flag</td>
<td>A flag</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="mhmessage">
<h3>18.3.2.3. <tt class="docutils literal"><span class="pre">MHMessage</span></tt><a class="headerlink" href="#mhmessage" title="Permalink to this headline">¶</a></h3>
<p>class class mailbox.MHMessage([message])</p>
<blockquote>
<p>A message with MH-specific behaviors. Parameter <em>message</em> has the
same meaning as with the <tt class="docutils literal"><span class="pre">Message</span></tt> constructor.</p>
<p>MH messages do not support marks or flags in the traditional sense,
but they do support sequences, which are logical groupings of
arbitrary messages. Some mail reading programs (although not the
standard <strong>mh</strong> and <strong>nmh</strong>) use sequences in much the same way
flags are used with other formats, as follows:</p>
<table border="1" class="docutils">
<colgroup>
<col width="21%" />
<col width="79%" />
</colgroup>
<thead valign="bottom">
<tr><th class="head">Sequence</th>
<th class="head">Explanation</th>
</tr>
</thead>
<tbody valign="top">
<tr><td>unseen</td>
<td>Not read, but previously detected by MUA</td>
</tr>
<tr><td>replied</td>
<td>Replied to</td>
</tr>
<tr><td>flagged</td>
<td>Marked as important</td>
</tr>
</tbody>
</table>
<p><tt class="docutils literal"><span class="pre">MHMessage</span></tt> instances offer the following methods:</p>
<p>get_sequences()</p>
<blockquote>
Return a list of the names of sequences that include this
message.</blockquote>
<p>set_sequences(sequences)</p>
<blockquote>
Set the list of sequences that include this message.</blockquote>
<p>add_sequence(sequence)</p>
<blockquote>
Add <em>sequence</em> to the list of sequences that include this
message.</blockquote>
<p>remove_sequence(sequence)</p>
<blockquote>
Remove <em>sequence</em> from the list of sequences that include this
message.</blockquote>
</blockquote>
<p>When an <tt class="docutils literal"><span class="pre">MHMessage</span></tt> instance is created based upon a
<tt class="docutils literal"><span class="pre">MaildirMessage</span></tt> instance, the following conversions take place:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr><th class="head">Resulting state</th>
<th class="head"><tt class="docutils literal"><span class="pre">MaildirMessage</span></tt> state</th>
</tr>
</thead>
<tbody valign="top">
<tr><td>&#8220;unseen&#8221; sequence</td>
<td>no S flag</td>
</tr>
<tr><td>&#8220;replied&#8221; sequence</td>
<td>R flag</td>
</tr>
<tr><td>&#8220;flagged&#8221; sequence</td>
<td>F flag</td>
</tr>
</tbody>
</table>
<p>When an <tt class="docutils literal"><span class="pre">MHMessage</span></tt> instance is created based upon an
<tt class="docutils literal"><span class="pre">mboxMessage</span></tt> or <tt class="docutils literal"><span class="pre">MMDFMessage</span></tt> instance, the <em>Status</em> and
<em>X-Status</em> headers are omitted and the following conversions take
place:</p>
<table border="1" class="docutils">
<colgroup>
<col width="31%" />
<col width="69%" />
</colgroup>
<thead valign="bottom">
<tr><th class="head">Resulting state</th>
<th class="head"><tt class="docutils literal"><span class="pre">mboxMessage</span></tt> or <tt class="docutils literal"><span class="pre">MMDFMessage</span></tt> state</th>
</tr>
</thead>
<tbody valign="top">
<tr><td>&#8220;unseen&#8221; sequence</td>
<td>no R flag</td>
</tr>
<tr><td>&#8220;replied&#8221; sequence</td>
<td>A flag</td>
</tr>
<tr><td>&#8220;flagged&#8221; sequence</td>
<td>F flag</td>
</tr>
</tbody>
</table>
<p>When an <tt class="docutils literal"><span class="pre">MHMessage</span></tt> instance is created based upon a
<tt class="docutils literal"><span class="pre">BabylMessage</span></tt> instance, the following conversions take place:</p>
<table border="1" class="docutils">
<colgroup>
<col width="42%" />
<col width="58%" />
</colgroup>
<thead valign="bottom">
<tr><th class="head">Resulting state</th>
<th class="head"><tt class="docutils literal"><span class="pre">BabylMessage</span></tt> state</th>
</tr>
</thead>
<tbody valign="top">
<tr><td>&#8220;unseen&#8221; sequence</td>
<td>&#8220;unseen&#8221; label</td>
</tr>
<tr><td>&#8220;replied&#8221; sequence</td>
<td>&#8220;answered&#8221; label</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="babylmessage">
<h3>18.3.2.4. <tt class="docutils literal"><span class="pre">BabylMessage</span></tt><a class="headerlink" href="#babylmessage" title="Permalink to this headline">¶</a></h3>
<p>class class mailbox.BabylMessage([message])</p>
<blockquote>
<p>A message with Babyl-specific behaviors. Parameter <em>message</em> has
the same meaning as with the <tt class="docutils literal"><span class="pre">Message</span></tt> constructor.</p>
<p>Certain message labels, called <em>attributes</em>, are defined by
convention to have special meanings. The attributes are as follows:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr><th class="head">Label</th>
<th class="head">Explanation</th>
</tr>
</thead>
<tbody valign="top">
<tr><td>unseen</td>
<td>Not read, but previously detected by MUA</td>
</tr>
<tr><td>deleted</td>
<td>Marked for subsequent deletion</td>
</tr>
<tr><td>filed</td>
<td>Copied to another file or mailbox</td>
</tr>
<tr><td>answered</td>
<td>Replied to</td>
</tr>
<tr><td>forwarded</td>
<td>Forwarded</td>
</tr>
<tr><td>edited</td>
<td>Modified by the user</td>
</tr>
<tr><td>resent</td>
<td>Resent</td>
</tr>
</tbody>
</table>
<p>By default, Rmail displays only visible headers. The
<tt class="docutils literal"><span class="pre">BabylMessage</span></tt> class, though, uses the original headers because
they are more complete. Visible headers may be accessed explicitly
if desired.</p>
<p><tt class="docutils literal"><span class="pre">BabylMessage</span></tt> instances offer the following methods:</p>
<p>get_labels()</p>
<blockquote>
Return a list of labels on the message.</blockquote>
<p>set_labels(labels)</p>
<blockquote>
Set the list of labels on the message to <em>labels</em>.</blockquote>
<p>add_label(label)</p>
<blockquote>
Add <em>label</em> to the list of labels on the message.</blockquote>
<p>remove_label(label)</p>
<blockquote>
Remove <em>label</em> from the list of labels on the message.</blockquote>
<p>get_visible()</p>
<blockquote>
Return an <tt class="docutils literal"><span class="pre">Message</span></tt> instance whose headers are the message&#8217;s
visible headers and whose body is empty.</blockquote>
<p>set_visible(visible)</p>
<blockquote>
Set the message&#8217;s visible headers to be the same as the headers
in <em>message</em>.  Parameter <em>visible</em> should be a <tt class="docutils literal"><span class="pre">Message</span></tt>
instance, an <tt class="docutils literal"><span class="pre">email.Message.Message</span></tt> instance, a string, or a
file-like object (which should be open in text mode).</blockquote>
<p>update_visible()</p>
<blockquote>
When a <tt class="docutils literal"><span class="pre">BabylMessage</span></tt> instance&#8217;s original headers are
modified, the visible headers are not automatically modified to
correspond. This method updates the visible headers as follows:
each visible header with a corresponding original header is set
to the value of the original header, each visible header without
a corresponding original header is removed, and any of <em>Date</em>,
<em>From</em>, <em>Reply-To</em>, <em>To</em>, <em>CC</em>, and <em>Subject</em> that are present
in the original headers but not the visible headers are added to
the visible headers.</blockquote>
</blockquote>
<p>When a <tt class="docutils literal"><span class="pre">BabylMessage</span></tt> instance is created based upon a
<tt class="docutils literal"><span class="pre">MaildirMessage</span></tt> instance, the following conversions take place:</p>
<table border="1" class="docutils">
<colgroup>
<col width="39%" />
<col width="61%" />
</colgroup>
<thead valign="bottom">
<tr><th class="head">Resulting state</th>
<th class="head"><tt class="docutils literal"><span class="pre">MaildirMessage</span></tt> state</th>
</tr>
</thead>
<tbody valign="top">
<tr><td>&#8220;unseen&#8221; label</td>
<td>no S flag</td>
</tr>
<tr><td>&#8220;deleted&#8221; label</td>
<td>T flag</td>
</tr>
<tr><td>&#8220;answered&#8221; label</td>
<td>R flag</td>
</tr>
<tr><td>&#8220;forwarded&#8221; label</td>
<td>P flag</td>
</tr>
</tbody>
</table>
<p>When a <tt class="docutils literal"><span class="pre">BabylMessage</span></tt> instance is created based upon an
<tt class="docutils literal"><span class="pre">mboxMessage</span></tt> or <tt class="docutils literal"><span class="pre">MMDFMessage</span></tt> instance, the <em>Status</em> and
<em>X-Status</em> headers are omitted and the following conversions take
place:</p>
<table border="1" class="docutils">
<colgroup>
<col width="29%" />
<col width="71%" />
</colgroup>
<thead valign="bottom">
<tr><th class="head">Resulting state</th>
<th class="head"><tt class="docutils literal"><span class="pre">mboxMessage</span></tt> or <tt class="docutils literal"><span class="pre">MMDFMessage</span></tt> state</th>
</tr>
</thead>
<tbody valign="top">
<tr><td>&#8220;unseen&#8221; label</td>
<td>no R flag</td>
</tr>
<tr><td>&#8220;deleted&#8221; label</td>
<td>D flag</td>
</tr>
<tr><td>&#8220;answered&#8221; label</td>
<td>A flag</td>
</tr>
</tbody>
</table>
<p>When a <tt class="docutils literal"><span class="pre">BabylMessage</span></tt> instance is created based upon an
<tt class="docutils literal"><span class="pre">MHMessage</span></tt> instance, the following conversions take place:</p>
<table border="1" class="docutils">
<colgroup>
<col width="42%" />
<col width="58%" />
</colgroup>
<thead valign="bottom">
<tr><th class="head">Resulting state</th>
<th class="head"><tt class="docutils literal"><span class="pre">MHMessage</span></tt> state</th>
</tr>
</thead>
<tbody valign="top">
<tr><td>&#8220;unseen&#8221; label</td>
<td>&#8220;unseen&#8221; sequence</td>
</tr>
<tr><td>&#8220;answered&#8221; label</td>
<td>&#8220;replied&#8221; sequence</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="mmdfmessage">
<h3>18.3.2.5. <tt class="docutils literal"><span class="pre">MMDFMessage</span></tt><a class="headerlink" href="#mmdfmessage" title="Permalink to this headline">¶</a></h3>
<p>class class mailbox.MMDFMessage([message])</p>
<blockquote>
<p>A message with MMDF-specific behaviors. Parameter <em>message</em> has the
same meaning as with the <tt class="docutils literal"><span class="pre">Message</span></tt> constructor.</p>
<p>As with message in an mbox mailbox, MMDF messages are stored with
the sender&#8217;s address and the delivery date in an initial line
beginning with &#8220;From &#8220;.  Likewise, flags that indicate the state of
the message are typically stored in <em>Status</em> and <em>X-Status</em>
headers.</p>
<p>Conventional flags for MMDF messages are identical to those of mbox
message and are as follows:</p>
<table border="1" class="docutils">
<colgroup>
<col width="15%" />
<col width="22%" />
<col width="63%" />
</colgroup>
<thead valign="bottom">
<tr><th class="head">Flag</th>
<th class="head">Meaning</th>
<th class="head">Explanation</th>
</tr>
</thead>
<tbody valign="top">
<tr><td>R</td>
<td>Read</td>
<td>Read</td>
</tr>
<tr><td>O</td>
<td>Old</td>
<td>Previously detected by MUA</td>
</tr>
<tr><td>D</td>
<td>Deleted</td>
<td>Marked for subsequent deletion</td>
</tr>
<tr><td>F</td>
<td>Flagged</td>
<td>Marked as important</td>
</tr>
<tr><td>A</td>
<td>Answered</td>
<td>Replied to</td>
</tr>
</tbody>
</table>
<p>The &#8220;R&#8221; and &#8220;O&#8221; flags are stored in the <em>Status</em> header, and the
&#8220;D&#8221;, &#8220;F&#8221;, and &#8220;A&#8221; flags are stored in the <em>X-Status</em> header. The
flags and headers typically appear in the order mentioned.</p>
<p><tt class="docutils literal"><span class="pre">MMDFMessage</span></tt> instances offer the following methods, which are
identical to those offered by <tt class="docutils literal"><span class="pre">mboxMessage</span></tt>:</p>
<p>get_from()</p>
<blockquote>
Return a string representing the &#8220;From &#8221; line that marks the
start of the message in an mbox mailbox. The leading &#8220;From &#8221; and
the trailing newline are excluded.</blockquote>
<p>set_from(from_[, time_=None])</p>
<blockquote>
Set the &#8220;From &#8221; line to <em>from_</em>, which should be specified
without a leading &#8220;From &#8221; or trailing newline. For convenience,
<em>time_</em> may be specified and will be formatted appropriately and
appended to <em>from_</em>. If <em>time_</em> is specified, it should be a
<tt class="docutils literal"><span class="pre">struct_time</span></tt> instance, a tuple suitable for passing to
<tt class="docutils literal"><span class="pre">time.strftime()</span></tt>, or <tt class="xref docutils literal"><span class="pre">True</span></tt> (to use <tt class="docutils literal"><span class="pre">time.gmtime()</span></tt>).</blockquote>
<p>get_flags()</p>
<blockquote>
Return a string specifying the flags that are currently set. If
the message complies with the conventional format, the result is
the concatenation in the following order of zero or one
occurrence of each of <tt class="docutils literal"><span class="pre">'R'</span></tt>, <tt class="docutils literal"><span class="pre">'O'</span></tt>, <tt class="docutils literal"><span class="pre">'D'</span></tt>, <tt class="docutils literal"><span class="pre">'F'</span></tt>, and
<tt class="docutils literal"><span class="pre">'A'</span></tt>.</blockquote>
<p>set_flags(flags)</p>
<blockquote>
Set the flags specified by <em>flags</em> and unset all others.
Parameter <em>flags</em> should be the concatenation in any order of
zero or more occurrences of each of <tt class="docutils literal"><span class="pre">'R'</span></tt>, <tt class="docutils literal"><span class="pre">'O'</span></tt>, <tt class="docutils literal"><span class="pre">'D'</span></tt>,
<tt class="docutils literal"><span class="pre">'F'</span></tt>, and <tt class="docutils literal"><span class="pre">'A'</span></tt>.</blockquote>
<p>add_flag(flag)</p>
<blockquote>
Set the flag(s) specified by <em>flag</em> without changing other
flags. To add more than one flag at a time, <em>flag</em> may be a
string of more than one character.</blockquote>
<p>remove_flag(flag)</p>
<blockquote>
Unset the flag(s) specified by <em>flag</em> without changing other
flags. To remove more than one flag at a time, <em>flag</em> maybe a
string of more than one character.</blockquote>
</blockquote>
<p>When an <tt class="docutils literal"><span class="pre">MMDFMessage</span></tt> instance is created based upon a
<tt class="docutils literal"><span class="pre">MaildirMessage</span></tt> instance, a &#8220;From &#8221; line is generated based upon
the <tt class="docutils literal"><span class="pre">MaildirMessage</span></tt> instance&#8217;s delivery date, and the following
conversions take place:</p>
<table border="1" class="docutils">
<colgroup>
<col width="37%" />
<col width="63%" />
</colgroup>
<thead valign="bottom">
<tr><th class="head">Resulting state</th>
<th class="head"><tt class="docutils literal"><span class="pre">MaildirMessage</span></tt> state</th>
</tr>
</thead>
<tbody valign="top">
<tr><td>R flag</td>
<td>S flag</td>
</tr>
<tr><td>O flag</td>
<td>&#8220;cur&#8221; subdirectory</td>
</tr>
<tr><td>D flag</td>
<td>T flag</td>
</tr>
<tr><td>F flag</td>
<td>F flag</td>
</tr>
<tr><td>A flag</td>
<td>R flag</td>
</tr>
</tbody>
</table>
<p>When an <tt class="docutils literal"><span class="pre">MMDFMessage</span></tt> instance is created based upon an
<tt class="docutils literal"><span class="pre">MHMessage</span></tt> instance, the following conversions take place:</p>
<table border="1" class="docutils">
<colgroup>
<col width="43%" />
<col width="57%" />
</colgroup>
<thead valign="bottom">
<tr><th class="head">Resulting state</th>
<th class="head"><tt class="docutils literal"><span class="pre">MHMessage</span></tt> state</th>
</tr>
</thead>
<tbody valign="top">
<tr><td>R flag and O flag</td>
<td>no &#8220;unseen&#8221; sequence</td>
</tr>
<tr><td>O flag</td>
<td>&#8220;unseen&#8221; sequence</td>
</tr>
<tr><td>F flag</td>
<td>&#8220;flagged&#8221; sequence</td>
</tr>
<tr><td>A flag</td>
<td>&#8220;replied&#8221; sequence</td>
</tr>
</tbody>
</table>
<p>When an <tt class="docutils literal"><span class="pre">MMDFMessage</span></tt> instance is created based upon a
<tt class="docutils literal"><span class="pre">BabylMessage</span></tt> instance, the following conversions take place:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr><th class="head">Resulting state</th>
<th class="head"><tt class="docutils literal"><span class="pre">BabylMessage</span></tt> state</th>
</tr>
</thead>
<tbody valign="top">
<tr><td>R flag and O flag</td>
<td>no &#8220;unseen&#8221; label</td>
</tr>
<tr><td>O flag</td>
<td>&#8220;unseen&#8221; label</td>
</tr>
<tr><td>D flag</td>
<td>&#8220;deleted&#8221; label</td>
</tr>
<tr><td>A flag</td>
<td>&#8220;answered&#8221; label</td>
</tr>
</tbody>
</table>
<p>When an <tt class="docutils literal"><span class="pre">MMDFMessage</span></tt> instance is created based upon an
<tt class="docutils literal"><span class="pre">mboxMessage</span></tt> instance, the &#8220;From &#8221; line is copied and all flags
directly correspond:</p>
<table border="1" class="docutils">
<colgroup>
<col width="39%" />
<col width="61%" />
</colgroup>
<thead valign="bottom">
<tr><th class="head">Resulting state</th>
<th class="head"><tt class="docutils literal"><span class="pre">mboxMessage</span></tt> state</th>
</tr>
</thead>
<tbody valign="top">
<tr><td>R flag</td>
<td>R flag</td>
</tr>
<tr><td>O flag</td>
<td>O flag</td>
</tr>
<tr><td>D flag</td>
<td>D flag</td>
</tr>
<tr><td>F flag</td>
<td>F flag</td>
</tr>
<tr><td>A flag</td>
<td>A flag</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="exceptions">
<h2>18.3.3. Exceptions<a class="headerlink" href="#exceptions" title="Permalink to this headline">¶</a></h2>
<p>The following exception classes are defined in the <tt class="docutils literal"><span class="pre">mailbox</span></tt> module:</p>
<p>exception exception mailbox.Error</p>
<blockquote>
The based class for all other module-specific exceptions.</blockquote>
<p>exception exception mailbox.NoSuchMailboxError</p>
<blockquote>
Raised when a mailbox is expected but is not found, such as when
instantiating a <tt class="docutils literal"><span class="pre">Mailbox</span></tt> subclass with a path that does not
exist (and with the <em>create</em> parameter set to <tt class="xref docutils literal"><span class="pre">False</span></tt>), or when
opening a folder that does not exist.</blockquote>
<p>exception exception mailbox.NotEmptyError</p>
<blockquote>
Raised when a mailbox is not empty but is expected to be, such as
when deleting a folder that contains messages.</blockquote>
<p>exception exception mailbox.ExternalClashError</p>
<blockquote>
Raised when some mailbox-related condition beyond the control of
the program causes it to be unable to proceed, such as when failing
to acquire a lock that another program already holds a lock, or
when a uniquely-generated file name already exists.</blockquote>
<p>exception exception mailbox.FormatError</p>
<blockquote>
Raised when the data in a file cannot be parsed, such as when an
<tt class="docutils literal"><span class="pre">MH</span></tt> instance attempts to read a corrupted <tt class="docutils literal"><span class="pre">.mh_sequences</span></tt>
file.</blockquote>
</div>
<div class="section" id="deprecated-classes-and-methods">
<h2>18.3.4. Deprecated classes and methods<a class="headerlink" href="#deprecated-classes-and-methods" title="Permalink to this headline">¶</a></h2>
<p>Deprecated since version 2.6.</p>
<p>Older versions of the <tt class="docutils literal"><span class="pre">mailbox</span></tt> module do not support modification
of mailboxes, such as adding or removing message, and do not provide
classes to represent format-specific message properties. For backward
compatibility, the older mailbox classes are still available, but the
newer classes should be used in preference to them.  The old classes
will be removed in Python 3.0.</p>
<p>Older mailbox objects support only iteration and provide a single
public method:</p>
<p>oldmailbox.next()</p>
<blockquote>
Return the next message in the mailbox, created with the optional
<em>factory</em> argument passed into the mailbox object&#8217;s constructor. By
default this is an <tt class="docutils literal"><span class="pre">rfc822.Message</span></tt> object (see the <tt class="docutils literal"><span class="pre">rfc822</span></tt>
module).  Depending on the mailbox implementation the <em>fp</em>
attribute of this object may be a true file object or a class
instance simulating a file object, taking care of things like
message boundaries if multiple mail messages are contained in a
single file, etc.  If no more messages are available, this method
returns <tt class="xref docutils literal"><span class="pre">None</span></tt>.</blockquote>
<p>Most of the older mailbox classes have names that differ from the
current mailbox class names, except for <tt class="docutils literal"><span class="pre">Maildir</span></tt>. For this reason,
the new <tt class="docutils literal"><span class="pre">Maildir</span></tt> class defines a <tt class="docutils literal"><span class="pre">next()</span></tt> method and its
constructor differs slightly from those of the other new mailbox
classes.</p>
<p>The older mailbox classes whose names are not the same as their newer
counterparts are as follows:</p>
<p>class class mailbox.UnixMailbox(fp[, factory])</p>
<blockquote>
<p>Access to a classic Unix-style mailbox, where all messages are
contained in a single file and separated by <tt class="docutils literal"><span class="pre">From</span></tt> (a.k.a.
<tt class="docutils literal"><span class="pre">From_</span></tt>) lines.  The file object <em>fp</em> points to the mailbox file.
The optional <em>factory</em> parameter is a callable that should create
new message objects.  <em>factory</em> is called with one argument, <em>fp</em>
by the <tt class="docutils literal"><span class="pre">next()</span></tt> method of the mailbox object.  The default is the
<tt class="docutils literal"><span class="pre">rfc822.Message</span></tt> class (see the <tt class="docutils literal"><span class="pre">rfc822</span></tt> module &#8211; and the note
below).</p>
<dl class="docutils">
<dt>Note: For reasons of this module&#8217;s internal implementation, you will</dt>
<dd>probably want to open the <em>fp</em> object in binary mode.  This is
especially important on Windows.</dd>
</dl>
<p>For maximum portability, messages in a Unix-style mailbox are
separated by any line that begins exactly with the string <tt class="docutils literal"><span class="pre">'From</span>
<span class="pre">'</span></tt> (note the trailing space) if preceded by exactly two newlines.
Because of the wide-range of variations in practice, nothing else
on the <tt class="docutils literal"><span class="pre">From_</span></tt> line should be considered.  However, the current
implementation doesn&#8217;t check for the leading two newlines.  This is
usually fine for most applications.</p>
<p>The <tt class="docutils literal"><span class="pre">UnixMailbox</span></tt> class implements a more strict version of
<tt class="docutils literal"><span class="pre">From_</span></tt> line checking, using a regular expression that usually
correctly matched <tt class="docutils literal"><span class="pre">From_</span></tt> delimiters.  It considers delimiter
line to be separated by <tt class="docutils literal"><span class="pre">From</span> <span class="pre">name</span> <span class="pre">time</span></tt> lines.  For maximum
portability, use the <tt class="docutils literal"><span class="pre">PortableUnixMailbox</span></tt> class instead.  This
class is identical to <tt class="docutils literal"><span class="pre">UnixMailbox</span></tt> except that individual
messages are separated by only <tt class="docutils literal"><span class="pre">From</span></tt> lines.</p>
</blockquote>
<p>class class mailbox.PortableUnixMailbox(fp[, factory])</p>
<blockquote>
A less-strict version of <tt class="docutils literal"><span class="pre">UnixMailbox</span></tt>, which considers only the
<tt class="docutils literal"><span class="pre">From</span></tt> at the beginning of the line separating messages.  The
&#8220;<em>name</em> <em>time</em>&#8221; portion of the From line is ignored, to protect
against some variations that are observed in practice.  This works
since lines in the message which begin with <tt class="docutils literal"><span class="pre">'From</span> <span class="pre">'</span></tt> are quoted
by mail handling software at delivery-time.</blockquote>
<p>class class mailbox.MmdfMailbox(fp[, factory])</p>
<blockquote>
Access an MMDF-style mailbox, where all messages are contained in a
single file and separated by lines consisting of 4 control-A
characters.  The file object <em>fp</em> points to the mailbox file.
Optional <em>factory</em> is as with the <tt class="docutils literal"><span class="pre">UnixMailbox</span></tt> class.</blockquote>
<p>class class mailbox.MHMailbox(dirname[, factory])</p>
<blockquote>
Access an MH mailbox, a directory with each message in a separate
file with a numeric name. The name of the mailbox directory is
passed in <em>dirname</em>. <em>factory</em> is as with the <tt class="docutils literal"><span class="pre">UnixMailbox</span></tt>
class.</blockquote>
<p>class class mailbox.BabylMailbox(fp[, factory])</p>
<blockquote>
Access a Babyl mailbox, which is similar to an MMDF mailbox.  In
Babyl format, each message has two sets of headers, the <em>original</em>
headers and the <em>visible</em> headers.  The original headers appear
before a line containing only <tt class="docutils literal"><span class="pre">'***</span> <span class="pre">EOOH</span> <span class="pre">***'</span></tt> (End-Of-Original-
Headers) and the visible headers appear after the <tt class="docutils literal"><span class="pre">EOOH</span></tt> line.
Babyl-compliant mail readers will show you only the visible
headers, and <tt class="docutils literal"><span class="pre">BabylMailbox</span></tt> objects will return messages
containing only the visible headers.  You&#8217;ll have to do your own
parsing of the mailbox file to get at the original headers.  Mail
messages start with the EOOH line and end with a line containing
only <tt class="docutils literal"><span class="pre">'\037\014'</span></tt>.  <em>factory</em> is as with the <tt class="docutils literal"><span class="pre">UnixMailbox</span></tt>
class.</blockquote>
<p>If you wish to use the older mailbox classes with the <tt class="docutils literal"><span class="pre">email</span></tt> module
rather than the deprecated <tt class="docutils literal"><span class="pre">rfc822</span></tt> module, you can do so as
follows:</p>
<blockquote>
<p>import email
import email.Errors
import mailbox</p>
<dl class="docutils">
<dt>def msgfactory(fp):</dt>
<dd><dl class="first last docutils">
<dt>try:</dt>
<dd>return email.message_from_file(fp)</dd>
<dt>except email.Errors.MessageParseError:</dt>
<dd># Don&#8217;t return None since that will
# stop the mailbox iterator
return &#8216;&#8217;</dd>
</dl>
</dd>
</dl>
<p>mbox = mailbox.UnixMailbox(fp, msgfactory)</p>
</blockquote>
<p>Alternatively, if you know your mailbox contains only well-formed MIME
messages, you can simplify this to:</p>
<blockquote>
<p>import email
import mailbox</p>
<p>mbox = mailbox.UnixMailbox(fp, email.message_from_file)</p>
</blockquote>
</div>
<div class="section" id="examples">
<h2>18.3.5. Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h2>
<p>A simple example of printing the subjects of all messages in a mailbox
that seem interesting:</p>
<blockquote>
<p>import mailbox
for message in mailbox.mbox(&#8216;~/mbox&#8217;):</p>
<blockquote>
<p>subject = message[&#8216;subject&#8217;]       # Could possibly be None.
if subject and &#8216;python&#8217; in subject.lower():</p>
<blockquote>
print subject</blockquote>
</blockquote>
</blockquote>
<p>To copy all mail from a Babyl mailbox to an MH mailbox, converting all
of the format-specific information that can be converted:</p>
<blockquote>
<p>import mailbox
destination = mailbox.MH(&#8216;~/Mail&#8217;)
destination.lock()
for message in mailbox.Babyl(&#8216;~/RMAIL&#8217;):</p>
<blockquote>
destination.add(mailbox.MHMessage(message))</blockquote>
<p>destination.flush()
destination.unlock()</p>
</blockquote>
<p>This example sorts mail from several mailing lists into different
mailboxes, being careful to avoid mail corruption due to concurrent
modification by other programs, mail loss due to interruption of the
program, or premature termination due to malformed messages in the
mailbox:</p>
<blockquote>
<p>import mailbox
import email.Errors</p>
<p>list_names = (&#8216;python-list&#8217;, &#8216;python-dev&#8217;, &#8216;python-bugs&#8217;)</p>
<p>boxes = dict((name, mailbox.mbox(&#8216;~/email/%s&#8217; % name)) for name in list_names)
inbox = mailbox.Maildir(&#8216;~/Maildir&#8217;, factory=None)</p>
<dl class="docutils">
<dt>for key in inbox.iterkeys():</dt>
<dd><dl class="first last docutils">
<dt>try:</dt>
<dd>message = inbox[key]</dd>
<dt>except email.Errors.MessageParseError:</dt>
<dd>continue                # The message is malformed. Just leave it.</dd>
<dt>for name in list_names:</dt>
<dd><p class="first">list_id = message[&#8216;list-id&#8217;]
if list_id and name in list_id:</p>
<blockquote class="last">
<p># Get mailbox to use
box = boxes[name]</p>
<p># Write copy to disk before removing original.
# If there&#8217;s a crash, you might duplicate a message, but
# that&#8217;s better than losing a message completely.
box.lock()
box.add(message)
box.flush()
box.unlock()</p>
<p># Remove original message
inbox.lock()
inbox.discard(key)
inbox.flush()
inbox.unlock()
break               # Found destination, so stop looking.</p>
</blockquote>
</dd>
</dl>
</dd>
<dt>for box in boxes.itervalues():</dt>
<dd>box.close()</dd>
</dl>
</blockquote>
</div>
</div>


          </div>
        </div>
      </div>


      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../modindex.html" title="Global Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="mhlib.html" title="18.4. mhlib — Access to MH mailboxes"
             >next</a> |</li>
        <li class="right" >
          <a href="mailcap.html" title="18.2. mailcap — Mailcap file handling"
             >previous</a> |</li>
        <li><a href="../index.html">Jython v2.5.2 documentation</a> &raquo;</li>
          <li><a href="indexprogress.html" >The Python Standard Library and What Comes with Jython</a> &raquo;</li>
          <li><a href="netdata.html" >18. Internet Data Handling</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
      &copy; <a href="../copyright.html">Copyright</a> 2011, Jython Project.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 0.6.4.
    </div>
  </body>
</html>