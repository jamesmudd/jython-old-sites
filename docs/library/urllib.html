<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>20.5. urllib — Open arbitrary resources by URL &mdash; Jython v2.5.2 documentation</title>
    <link rel="stylesheet" href="../_static/green-theme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '2.5.2',
        COLLAPSE_MODINDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="copyright" title="Copyright" href="../copyright.html" />
    <link rel="top" title="Jython v2.5.2 documentation" href="../index.html" />
    <link rel="up" title="20. Internet Protocols and Support" href="internet.html" />
    <link rel="next" title="20.6. urllib2 — extensible library for opening URLs" href="urllib2.html" />
    <link rel="prev" title="20.4. wsgiref — WSGI Utilities and Reference Implementation" href="wsgiref.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../modindex.html" title="Global Module Index"
             accesskey="M">modules</a> |</li>
        <li class="right" >
          <a href="urllib2.html" title="20.6. urllib2 — extensible library for opening URLs"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="wsgiref.html" title="20.4. wsgiref — WSGI Utilities and Reference Implementation"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">Jython v2.5.2 documentation</a> &raquo;</li>
          <li><a href="indexprogress.html" >The Python Standard Library and What Comes with Jython</a> &raquo;</li>
          <li><a href="internet.html" accesskey="U">20. Internet Protocols and Support</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/jython.png" alt="Logo"/>
            </a></p>
            <h3><a href="../index.html">Table Of Contents</a></h3>
            <ul>
<li><a class="reference external" href="#">20.5. <tt class="docutils literal"><span class="pre">urllib</span></tt> &#8212; Open arbitrary resources by URL</a><ul>
<li><a class="reference external" href="#high-level-interface">20.5.1. High-level interface</a></li>
<li><a class="reference external" href="#utility-functions">20.5.2. Utility functions</a></li>
<li><a class="reference external" href="#url-opener-objects">20.5.3. URL Opener objects</a></li>
<li><a class="reference external" href="#urllib-restrictions">20.5.4. <tt class="docutils literal"><span class="pre">urllib</span></tt> Restrictions</a></li>
<li><a class="reference external" href="#examples">20.5.5. Examples</a></li>
</ul>
</li>
</ul>

            <h4>Previous topic</h4>
            <p class="topless"><a href="wsgiref.html"
                                  title="previous chapter">20.4. <tt class="docutils literal docutils literal"><span class="pre">wsgiref</span></tt> &#8212; WSGI Utilities and Reference Implementation</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="urllib2.html"
                                  title="next chapter">20.6. <tt class="docutils literal docutils literal"><span class="pre">urllib2</span></tt> &#8212; extensible library for opening URLs</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="../_sources/library/urllib.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="../search.html" method="get">
                <input type="text" name="q" size="18" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="urllib-open-arbitrary-resources-by-url">
<h1>20.5. <tt class="docutils literal"><span class="pre">urllib</span></tt> &#8212; Open arbitrary resources by URL<a class="headerlink" href="#urllib-open-arbitrary-resources-by-url" title="Permalink to this headline">¶</a></h1>
<dl class="docutils">
<dt>Note: The <tt class="docutils literal"><span class="pre">urllib</span></tt> module has been split into parts and renamed in</dt>
<dd>Python 3.0 to <tt class="docutils literal"><span class="pre">urllib.request</span></tt>, <tt class="docutils literal"><span class="pre">urllib.parse</span></tt>, and
<tt class="docutils literal"><span class="pre">urllib.error</span></tt>. The <em>2to3</em> tool will automatically adapt imports
when converting your sources to 3.0. Also note that the
<tt class="docutils literal"><span class="pre">urllib.urlopen()</span></tt> function has been removed in Python 3.0 in
favor of <tt class="docutils literal"><span class="pre">urllib2.urlopen()</span></tt>.</dd>
</dl>
<p>This module provides a high-level interface for fetching data across
the World Wide Web.  In particular, the <tt class="docutils literal"><span class="pre">urlopen()</span></tt> function is
similar to the built-in function <tt class="docutils literal"><span class="pre">open()</span></tt>, but accepts Universal
Resource Locators (URLs) instead of filenames.  Some restrictions
apply &#8212; it can only open URLs for reading, and no seek operations
are available.</p>
<div class="section" id="high-level-interface">
<h2>20.5.1. High-level interface<a class="headerlink" href="#high-level-interface" title="Permalink to this headline">¶</a></h2>
<p>urllib.urlopen(url[, data[, proxies]])</p>
<blockquote>
<p>Open a network object denoted by a URL for reading.  If the URL
does not have a scheme identifier, or if it has <tt class="docutils literal"><span class="pre">file:</span></tt> as its
scheme identifier, this opens a local file (without universal
newlines); otherwise it opens a socket to a server somewhere on the
network.  If the connection cannot be made the <tt class="docutils literal"><span class="pre">IOError</span></tt>
exception is raised.  If all went well, a file-like object is
returned.  This supports the following methods: <tt class="docutils literal"><span class="pre">read()</span></tt>,
<tt class="docutils literal"><span class="pre">readline()</span></tt>, <tt class="docutils literal"><span class="pre">readlines()</span></tt>, <tt class="docutils literal"><span class="pre">fileno()</span></tt>, <tt class="docutils literal"><span class="pre">close()</span></tt>,
<tt class="docutils literal"><span class="pre">info()</span></tt>, <tt class="docutils literal"><span class="pre">getcode()</span></tt> and <tt class="docutils literal"><span class="pre">geturl()</span></tt>.  It also has proper
support for the <em>iterator</em> protocol. One caveat: the <tt class="docutils literal"><span class="pre">read()</span></tt>
method, if the size argument is omitted or negative, may not read
until the end of the data stream; there is no good way to determine
that the entire stream from a socket has been read in the general
case.</p>
<p>Except for the <tt class="docutils literal"><span class="pre">info()</span></tt>, <tt class="docutils literal"><span class="pre">getcode()</span></tt> and <tt class="docutils literal"><span class="pre">geturl()</span></tt> methods,
these methods have the same interface as for file objects &#8212; see
section <em>File Objects</em> in this manual.  (It is not a built-in file
object, however, so it can&#8217;t be used at those few places where a
true built-in file object is required.)</p>
<p>The <tt class="docutils literal"><span class="pre">info()</span></tt> method returns an instance of the class
<tt class="docutils literal"><span class="pre">httplib.HTTPMessage</span></tt> containing meta-information associated with
the URL.  When the method is HTTP, these headers are those returned
by the server at the head of the retrieved HTML page (including
Content-Length and Content-Type).  When the method is FTP, a
Content-Length header will be present if (as is now usual) the
server passed back a file length in response to the FTP retrieval
request. A Content-Type header will be present if the MIME type can
be guessed.  When the method is local-file, returned headers will
include a Date representing the file&#8217;s last-modified time, a
Content-Length giving file size, and a Content-Type containing a
guess at the file&#8217;s type. See also the description of the
<tt class="docutils literal"><span class="pre">mimetools</span></tt> module.</p>
<p>The <tt class="docutils literal"><span class="pre">geturl()</span></tt> method returns the real URL of the page.  In some
cases, the HTTP server redirects a client to another URL.  The
<tt class="docutils literal"><span class="pre">urlopen()</span></tt> function handles this transparently, but in some
cases the caller needs to know which URL the client was redirected
to.  The <tt class="docutils literal"><span class="pre">geturl()</span></tt> method can be used to get at this redirected
URL.</p>
<p>The <tt class="docutils literal"><span class="pre">getcode()</span></tt> method returns the HTTP status code that was sent
with the response, or <tt class="xref docutils literal"><span class="pre">None</span></tt> if the URL is no HTTP URL.</p>
<p>If the <em>url</em> uses the <tt class="docutils literal"><span class="pre">http:</span></tt> scheme identifier, the optional
<em>data</em> argument may be given to specify a <tt class="docutils literal"><span class="pre">POST</span></tt> request
(normally the request type is <tt class="docutils literal"><span class="pre">GET</span></tt>).  The <em>data</em> argument must
be in standard <em>application/x-www-form-urlencoded</em> format; see the
<tt class="docutils literal"><span class="pre">urlencode()</span></tt> function below.</p>
<p>The <tt class="docutils literal"><span class="pre">urlopen()</span></tt> function works transparently with proxies which
do not require authentication.  In a Unix or Windows environment,
set the <strong>http_proxy</strong>, or <strong>ftp_proxy</strong> environment variables to a
URL that identifies the proxy server before starting the Python
interpreter.  For example (the <tt class="docutils literal"><span class="pre">'%'</span></tt> is the command prompt):</p>
<blockquote>
% http_proxy=&#8221;<a class="reference external" href="http://www.someproxy.com:3128">http://www.someproxy.com:3128</a>&#8221;
% export http_proxy
% python
...</blockquote>
<p>The <strong>no_proxy</strong> environment variable can be used to specify hosts
which shouldn&#8217;t be reached via proxy; if set, it should be a comma-
separated list of hostname suffixes, optionally with <tt class="docutils literal"><span class="pre">:port</span></tt>
appended, for example <tt class="docutils literal"><span class="pre">cern.ch,ncsa.uiuc.edu,some.host:8080</span></tt>.</p>
<p>In a Windows environment, if no proxy environment variables are
set, proxy settings are obtained from the registry&#8217;s Internet
Settings section.</p>
<p>In a Macintosh environment, <tt class="docutils literal"><span class="pre">urlopen()</span></tt> will retrieve proxy
information from Internet Config.</p>
<p>Alternatively, the optional <em>proxies</em> argument may be used to
explicitly specify proxies.  It must be a dictionary mapping scheme
names to proxy URLs, where an empty dictionary causes no proxies to
be used, and <tt class="xref docutils literal"><span class="pre">None</span></tt> (the default value) causes environmental
proxy settings to be used as discussed above.  For example:</p>
<blockquote>
# Use <a class="reference external" href="http://www.someproxy.com:3128">http://www.someproxy.com:3128</a> for http proxying
proxies = {&#8216;http&#8217;: &#8216;<a class="reference external" href="http://www.someproxy.com:3128">http://www.someproxy.com:3128</a>&#8216;}
filehandle = urllib.urlopen(some_url, proxies=proxies)
# Don&#8217;t use any proxies
filehandle = urllib.urlopen(some_url, proxies={})
# Use proxies from environment - both versions are equivalent
filehandle = urllib.urlopen(some_url, proxies=None)
filehandle = urllib.urlopen(some_url)</blockquote>
<p>Proxies which require authentication for use are not currently
supported; this is considered an implementation limitation.</p>
<p>Changed in version 2.3: Added the <em>proxies</em> support.</p>
<p>Changed in version 2.6: Added <tt class="docutils literal"><span class="pre">getcode()</span></tt> to returned object and
support for the <strong>no_proxy</strong> environment variable.</p>
<p>Deprecated since version 2.6: The <tt class="docutils literal"><span class="pre">urlopen()</span></tt> function has been
removed in Python 3.0 in favor of <tt class="docutils literal"><span class="pre">urllib2.urlopen()</span></tt>.</p>
</blockquote>
<p>urllib.urlretrieve(url[, filename[, reporthook[, data]]])</p>
<blockquote>
<p>Copy a network object denoted by a URL to a local file, if
necessary. If the URL points to a local file, or a valid cached
copy of the object exists, the object is not copied.  Return a
tuple <tt class="docutils literal"><span class="pre">(filename,</span> <span class="pre">headers)</span></tt> where <em>filename</em> is the local file
name under which the object can be found, and <em>headers</em> is whatever
the <tt class="docutils literal"><span class="pre">info()</span></tt> method of the object returned by <tt class="docutils literal"><span class="pre">urlopen()</span></tt>
returned (for a remote object, possibly cached). Exceptions are the
same as for <tt class="docutils literal"><span class="pre">urlopen()</span></tt>.</p>
<p>The second argument, if present, specifies the file location to
copy to (if absent, the location will be a tempfile with a
generated name). The third argument, if present, is a hook function
that will be called once on establishment of the network connection
and once after each block read thereafter.  The hook will be passed
three arguments; a count of blocks transferred so far, a block size
in bytes, and the total size of the file.  The third argument may
be <tt class="docutils literal"><span class="pre">-1</span></tt> on older FTP servers which do not return a file size in
response to a retrieval request.</p>
<p>If the <em>url</em> uses the <tt class="docutils literal"><span class="pre">http:</span></tt> scheme identifier, the optional
<em>data</em> argument may be given to specify a <tt class="docutils literal"><span class="pre">POST</span></tt> request
(normally the request type is <tt class="docutils literal"><span class="pre">GET</span></tt>).  The <em>data</em> argument must
in standard <em>application/x-www-form-urlencoded</em> format; see the
<tt class="docutils literal"><span class="pre">urlencode()</span></tt> function below.</p>
<p>Changed in version 2.5: <tt class="docutils literal"><span class="pre">urlretrieve()</span></tt> will raise
<tt class="docutils literal"><span class="pre">ContentTooShortError</span></tt> when it detects that the amount of data
available  was less than the expected amount (which is the size
reported by a  <em>Content-Length</em> header). This can occur, for
example, when the  download is interrupted.The <em>Content-Length</em> is
treated as a lower bound: if there&#8217;s more data  to read,
urlretrieve reads more data, but if less data is available,  it
raises the exception.You can still retrieve the downloaded data in
this case, it is stored  in the <tt class="docutils literal"><span class="pre">content</span></tt> attribute of the
exception instance.If no <em>Content-Length</em> header was supplied,
urlretrieve can not check the size of the data it has downloaded,
and just returns it.  In this case you just have to assume that the
download was successful.</p>
</blockquote>
<p>urllib._urlopener</p>
<blockquote>
<p>The public functions <tt class="docutils literal"><span class="pre">urlopen()</span></tt> and <tt class="docutils literal"><span class="pre">urlretrieve()</span></tt> create an
instance of the <tt class="docutils literal"><span class="pre">FancyURLopener</span></tt> class and use it to perform
their requested actions.  To override this functionality,
programmers can create a subclass of <tt class="docutils literal"><span class="pre">URLopener</span></tt> or
<tt class="docutils literal"><span class="pre">FancyURLopener</span></tt>, then assign an instance of that class to the
<tt class="docutils literal"><span class="pre">urllib._urlopener</span></tt> variable before calling the desired function.
For example, applications may want to specify a different <em>User-
Agent</em> header than <tt class="docutils literal"><span class="pre">URLopener</span></tt> defines.  This can be accomplished
with the following code:</p>
<blockquote>
<p>import urllib</p>
<dl class="docutils">
<dt>class AppURLopener(urllib.FancyURLopener):</dt>
<dd>version = &#8220;App/1.7&#8221;</dd>
</dl>
<p>urllib._urlopener = AppURLopener()</p>
</blockquote>
</blockquote>
<p>urllib.urlcleanup()</p>
<blockquote>
Clear the cache that may have been built up by previous calls to
<tt class="docutils literal"><span class="pre">urlretrieve()</span></tt>.</blockquote>
</div>
<div class="section" id="utility-functions">
<h2>20.5.2. Utility functions<a class="headerlink" href="#utility-functions" title="Permalink to this headline">¶</a></h2>
<p>urllib.quote(string[, safe])</p>
<blockquote>
<p>Replace special characters in <em>string</em> using the <tt class="docutils literal"><span class="pre">%xx</span></tt> escape.
Letters, digits, and the characters <tt class="docutils literal"><span class="pre">'_.-'</span></tt> are never quoted. The
optional <em>safe</em> parameter specifies additional characters that
should not be quoted &#8212; its default value is <tt class="docutils literal"><span class="pre">'/'</span></tt>.</p>
<p>Example: <tt class="docutils literal"><span class="pre">quote('/~connolly/')</span></tt> yields <tt class="docutils literal"><span class="pre">'/%7econnolly/'</span></tt>.</p>
</blockquote>
<p>urllib.quote_plus(string[, safe])</p>
<blockquote>
Like <tt class="docutils literal"><span class="pre">quote()</span></tt>, but also replaces spaces by plus signs, as
required for quoting HTML form values.  Plus signs in the original
string are escaped unless they are included in <em>safe</em>.  It also
does not have <em>safe</em> default to <tt class="docutils literal"><span class="pre">'/'</span></tt>.</blockquote>
<p>urllib.unquote(string)</p>
<blockquote>
<p>Replace <tt class="docutils literal"><span class="pre">%xx</span></tt> escapes by their single-character equivalent.</p>
<p>Example: <tt class="docutils literal"><span class="pre">unquote('/%7Econnolly/')</span></tt> yields <tt class="docutils literal"><span class="pre">'/~connolly/'</span></tt>.</p>
</blockquote>
<p>urllib.unquote_plus(string)</p>
<blockquote>
Like <tt class="docutils literal"><span class="pre">unquote()</span></tt>, but also replaces plus signs by spaces, as
required for unquoting HTML form values.</blockquote>
<p>urllib.urlencode(query[, doseq])</p>
<blockquote>
Convert a mapping object or a sequence of two-element tuples  to a
&#8220;url-encoded&#8221; string, suitable to pass to <tt class="docutils literal"><span class="pre">urlopen()</span></tt> above as
the optional <em>data</em> argument.  This is useful to pass a dictionary
of form fields to a <tt class="docutils literal"><span class="pre">POST</span></tt> request.  The resulting string is a
series of <tt class="docutils literal"><span class="pre">key=value</span></tt> pairs separated by <tt class="docutils literal"><span class="pre">'&amp;'</span></tt> characters,
where both <em>key</em> and <em>value</em> are quoted using <tt class="docutils literal"><span class="pre">quote_plus()</span></tt>
above.  If the optional parameter <em>doseq</em> is present and evaluates
to true, individual <tt class="docutils literal"><span class="pre">key=value</span></tt> pairs are generated for each
element of the sequence. When a sequence of two-element tuples is
used as the <em>query</em> argument, the first element of each tuple is a
key and the second is a value. The order of parameters in the
encoded string will match the order of parameter tuples in the
sequence. The <tt class="docutils literal"><span class="pre">urlparse</span></tt> module provides the functions
<tt class="docutils literal"><span class="pre">parse_qs()</span></tt> and <tt class="docutils literal"><span class="pre">parse_qsl()</span></tt> which are used to parse query
strings into Python data structures.</blockquote>
<p>urllib.pathname2url(path)</p>
<blockquote>
Convert the pathname <em>path</em> from the local syntax for a path to the
form used in the path component of a URL.  This does not produce a
complete URL.  The return value will already be quoted using the
<tt class="docutils literal"><span class="pre">quote()</span></tt> function.</blockquote>
<p>urllib.url2pathname(path)</p>
<blockquote>
Convert the path component <em>path</em> from an encoded URL to the local
syntax for a path.  This does not accept a complete URL.  This
function uses <tt class="docutils literal"><span class="pre">unquote()</span></tt> to decode <em>path</em>.</blockquote>
</div>
<div class="section" id="url-opener-objects">
<h2>20.5.3. URL Opener objects<a class="headerlink" href="#url-opener-objects" title="Permalink to this headline">¶</a></h2>
<p>class class urllib.URLopener([proxies[, <a href="#id1"><span class="problematic" id="id2">**</span></a>x509]])</p>
<blockquote>
<p>Base class for opening and reading URLs.  Unless you need to
support opening objects using schemes other than <tt class="docutils literal"><span class="pre">http:</span></tt>,
<tt class="docutils literal"><span class="pre">ftp:</span></tt>, or <tt class="docutils literal"><span class="pre">file:</span></tt>, you probably want to use
<tt class="docutils literal"><span class="pre">FancyURLopener</span></tt>.</p>
<p>By default, the <tt class="docutils literal"><span class="pre">URLopener</span></tt> class sends a <em>User-Agent</em> header of
<tt class="docutils literal"><span class="pre">urllib/VVV</span></tt>, where <em>VVV</em> is the <tt class="docutils literal"><span class="pre">urllib</span></tt> version number.
Applications can define their own <em>User-Agent</em> header by
subclassing <tt class="docutils literal"><span class="pre">URLopener</span></tt> or <tt class="docutils literal"><span class="pre">FancyURLopener</span></tt> and setting the
class attribute <tt class="docutils literal"><span class="pre">version</span></tt> to an appropriate string value in the
subclass definition.</p>
<p>The optional <em>proxies</em> parameter should be a dictionary mapping
scheme names to proxy URLs, where an empty dictionary turns proxies
off completely.  Its default value is <tt class="xref docutils literal"><span class="pre">None</span></tt>, in which case
environmental proxy settings will be used if present, as discussed
in the definition of <tt class="docutils literal"><span class="pre">urlopen()</span></tt>, above.</p>
<p>Additional keyword parameters, collected in <em>x509</em>, may be used for
authentication of the client when using the <tt class="docutils literal"><span class="pre">https:</span></tt> scheme.  The
keywords <em>key_file</em> and <em>cert_file</em> are supported to provide an
SSL key and certificate; both are needed to support client
authentication.</p>
<p><tt class="docutils literal"><span class="pre">URLopener</span></tt> objects will raise an <tt class="docutils literal"><span class="pre">IOError</span></tt> exception if the
server returns an error code.</p>
<blockquote>
<p>open(fullurl[, data])</p>
<blockquote>
Open <em>fullurl</em> using the appropriate protocol.  This method
sets up cache and proxy information, then calls the
appropriate open method with its input arguments.  If the
scheme is not recognized, <tt class="docutils literal"><span class="pre">open_unknown()</span></tt> is called. The
<em>data</em> argument has the same meaning as the <em>data</em> argument
of <tt class="docutils literal"><span class="pre">urlopen()</span></tt>.</blockquote>
<p>open_unknown(fullurl[, data])</p>
<blockquote>
Overridable interface to open unknown URL types.</blockquote>
<p>retrieve(url[, filename[, reporthook[, data]]])</p>
<blockquote>
<p>Retrieves the contents of <em>url</em> and places it in <em>filename</em>.
The return value is a tuple consisting of a local filename
and either a <tt class="docutils literal"><span class="pre">mimetools.Message</span></tt> object containing the
response headers (for remote URLs) or <tt class="xref docutils literal"><span class="pre">None</span></tt> (for local
URLs).  The caller must then open and read the contents of
<em>filename</em>.  If <em>filename</em> is not given and the URL refers to
a local file, the input filename is returned.  If the URL is
non-local and <em>filename</em> is not given, the filename is the
output of <tt class="docutils literal"><span class="pre">tempfile.mktemp()</span></tt> with a suffix that matches
the suffix of the last path component of the input URL.  If
<em>reporthook</em> is given, it must be a function accepting three
numeric parameters.  It will be called after each chunk of
data is read from the network.  <em>reporthook</em> is ignored for
local URLs.</p>
<p>If the <em>url</em> uses the <tt class="docutils literal"><span class="pre">http:</span></tt> scheme identifier, the
optional <em>data</em> argument may be given to specify a <tt class="docutils literal"><span class="pre">POST</span></tt>
request (normally the request type is <tt class="docutils literal"><span class="pre">GET</span></tt>).  The <em>data</em>
argument must in standard <em>application/x-www-form-urlencoded</em>
format; see the <tt class="docutils literal"><span class="pre">urlencode()</span></tt> function below.</p>
</blockquote>
<p>version</p>
<blockquote>
Variable that specifies the user agent of the opener object.
To get <tt class="docutils literal"><span class="pre">urllib</span></tt> to tell servers that it is a particular
user agent, set this in a subclass as a class variable or in
the constructor before calling the base constructor.</blockquote>
</blockquote>
</blockquote>
<p>class class urllib.FancyURLopener(...)</p>
<blockquote>
<p><tt class="docutils literal"><span class="pre">FancyURLopener</span></tt> subclasses <tt class="docutils literal"><span class="pre">URLopener</span></tt> providing default
handling for the following HTTP response codes: 301, 302, 303, 307
and 401.  For the 30x response codes listed above, the <em>Location</em>
header is used to fetch the actual URL.  For 401 response codes
(authentication required), basic HTTP authentication is performed.
For the 30x response codes, recursion is bounded by the value of
the <em>maxtries</em> attribute, which defaults to 10.</p>
<p>For all other response codes, the method <tt class="docutils literal"><span class="pre">http_error_default()</span></tt>
is called which you can override in subclasses to handle the error
appropriately.</p>
<dl class="docutils">
<dt>Note: According to the letter of <strong>RFC 2616</strong>, 301 and 302 responses to</dt>
<dd>POST requests must not be automatically redirected without
confirmation by the user.  In reality, browsers do allow
automatic redirection of these responses, changing the POST to a
GET, and <tt class="docutils literal"><span class="pre">urllib</span></tt> reproduces this behaviour.</dd>
</dl>
<p>The parameters to the constructor are the same as those for
<tt class="docutils literal"><span class="pre">URLopener</span></tt>.</p>
<blockquote>
<blockquote>
<dl class="docutils">
<dt>Note: When performing basic authentication, a <tt class="docutils literal"><span class="pre">FancyURLopener</span></tt></dt>
<dd>instance calls its <tt class="docutils literal"><span class="pre">prompt_user_passwd()</span></tt> method.  The
default implementation asks the users for the required
information on the controlling terminal.  A subclass may
override this method to support more appropriate behavior if
needed.</dd>
</dl>
</blockquote>
<p>The <tt class="docutils literal"><span class="pre">FancyURLopener</span></tt> class offers one additional method that
should be overloaded to provide the appropriate behavior:</p>
<p>prompt_user_passwd(host, realm)</p>
<blockquote>
<p>Return information needed to authenticate the user at the
given host in the specified security realm.  The return value
should be a tuple, <tt class="docutils literal"><span class="pre">(user,</span> <span class="pre">password)</span></tt>, which can be used for
basic authentication.</p>
<p>The implementation prompts for this information on the
terminal; an application should override this method to use an
appropriate interaction model in the local environment.</p>
</blockquote>
</blockquote>
</blockquote>
<p>exception exception urllib.ContentTooShortError(msg[, content])</p>
<blockquote>
<p>This exception is raised when the <tt class="docutils literal"><span class="pre">urlretrieve()</span></tt> function
detects that the amount of the downloaded data is less than the
expected amount (given by the <em>Content-Length</em> header). The
<tt class="docutils literal"><span class="pre">content</span></tt> attribute stores the downloaded (and supposedly
truncated) data.</p>
<p>New in version 2.5.</p>
</blockquote>
</div>
<div class="section" id="urllib-restrictions">
<h2>20.5.4. <tt class="docutils literal"><span class="pre">urllib</span></tt> Restrictions<a class="headerlink" href="#urllib-restrictions" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Currently, only the following protocols are supported: HTTP,
(versions 0.9 and 1.0),  FTP, and local files.</li>
<li>The caching feature of <tt class="docutils literal"><span class="pre">urlretrieve()</span></tt> has been disabled until I
find the time to hack proper processing of Expiration time headers.</li>
<li>There should be a function to query whether a particular URL is in
the cache.</li>
<li>For backward compatibility, if a URL appears to point to a local
file but the file can&#8217;t be opened, the URL is re-interpreted using
the FTP protocol.  This can sometimes cause confusing error
messages.</li>
<li>The <tt class="docutils literal"><span class="pre">urlopen()</span></tt> and <tt class="docutils literal"><span class="pre">urlretrieve()</span></tt> functions can cause
arbitrarily long delays while waiting for a network connection to be
set up.  This means that it is difficult to build an interactive Web
client using these functions without using threads.</li>
<li>The data returned by <tt class="docutils literal"><span class="pre">urlopen()</span></tt> or <tt class="docutils literal"><span class="pre">urlretrieve()</span></tt> is the raw
data returned by the server.  This may be binary data (such as an
image), plain text or (for example) HTML.  The HTTP protocol
provides type information in the reply header, which can be
inspected by looking at the <em>Content-Type</em> header.  If the returned
data is HTML, you can use the module <tt class="docutils literal"><span class="pre">htmllib</span></tt> to parse it.</li>
<li>The code handling the FTP protocol cannot differentiate between a
file and a directory.  This can lead to unexpected behavior when
attempting to read a URL that points to a file that is not
accessible.  If the URL ends in a <tt class="docutils literal"><span class="pre">/</span></tt>, it is assumed to refer to a
directory and will be handled accordingly.  But if an attempt to
read a file leads to a 550 error (meaning the URL cannot be found or
is not accessible, often for permission reasons), then the path is
treated as a directory in order to handle the case when a directory
is specified by a URL but the trailing <tt class="docutils literal"><span class="pre">/</span></tt> has been left off.
This can cause misleading results when you try to fetch a file whose
read permissions make it inaccessible; the FTP code will try to read
it, fail with a 550 error, and then perform a directory listing for
the unreadable file. If fine-grained control is needed, consider
using the <tt class="docutils literal"><span class="pre">ftplib</span></tt> module, subclassing <tt class="docutils literal"><span class="pre">FancyURLOpener</span></tt>, or
changing <em>_urlopener</em> to meet your needs.</li>
<li>This module does not support the use of proxies which require
authentication. This may be implemented in the future.</li>
<li>Although the <tt class="docutils literal"><span class="pre">urllib</span></tt> module contains (undocumented) routines to
parse and unparse URL strings, the recommended interface for URL
manipulation is in module <tt class="docutils literal"><span class="pre">urlparse</span></tt>.</li>
</ul>
</div>
<div class="section" id="examples">
<h2>20.5.5. Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h2>
<p>Here is an example session that uses the <tt class="docutils literal"><span class="pre">GET</span></tt> method to retrieve a
URL containing parameters:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">urllib</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">params</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">urlencode</span><span class="p">({</span><span class="s">&#39;spam&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&#39;eggs&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s">&#39;bacon&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="s">&quot;http://www.musi-cal.com/cgi-bin/query?</span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">params</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</pre></div>
</div>
<p>The following example uses the <tt class="docutils literal"><span class="pre">POST</span></tt> method instead:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">urllib</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">params</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">urlencode</span><span class="p">({</span><span class="s">&#39;spam&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&#39;eggs&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s">&#39;bacon&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="s">&quot;http://www.musi-cal.com/cgi-bin/query&quot;</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</pre></div>
</div>
<p>The following example uses an explicitly specified HTTP proxy,
overriding environment settings:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">urllib</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">proxies</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;http&#39;</span><span class="p">:</span> <span class="s">&#39;http://proxy.example.com:8080/&#39;</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">opener</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">FancyURLopener</span><span class="p">(</span><span class="n">proxies</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">opener</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s">&quot;http://www.python.org&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</pre></div>
</div>
<p>The following example uses no proxies at all, overriding environment
settings:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">urllib</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">opener</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">FancyURLopener</span><span class="p">({})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">opener</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s">&quot;http://www.python.org/&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>


      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../modindex.html" title="Global Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="urllib2.html" title="20.6. urllib2 — extensible library for opening URLs"
             >next</a> |</li>
        <li class="right" >
          <a href="wsgiref.html" title="20.4. wsgiref — WSGI Utilities and Reference Implementation"
             >previous</a> |</li>
        <li><a href="../index.html">Jython v2.5.2 documentation</a> &raquo;</li>
          <li><a href="indexprogress.html" >The Python Standard Library and What Comes with Jython</a> &raquo;</li>
          <li><a href="internet.html" >20. Internet Protocols and Support</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
      &copy; <a href="../copyright.html">Copyright</a> 2011, Jython Project.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 0.6.4.
    </div>
  </body>
</html>