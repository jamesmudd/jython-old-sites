<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>8.3. collections — High-performance container datatypes &mdash; Jython v2.5.2 documentation</title>
    <link rel="stylesheet" href="../_static/green-theme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '2.5.2',
        COLLAPSE_MODINDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="copyright" title="Copyright" href="../copyright.html" />
    <link rel="top" title="Jython v2.5.2 documentation" href="../index.html" />
    <link rel="up" title="8. Data Types" href="datatypes.html" />
    <link rel="next" title="8.4. heapq — Heap queue algorithm" href="heapq.html" />
    <link rel="prev" title="8.2. calendar — General calendar-related functions" href="calendar.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../modindex.html" title="Global Module Index"
             accesskey="M">modules</a> |</li>
        <li class="right" >
          <a href="heapq.html" title="8.4. heapq — Heap queue algorithm"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="calendar.html" title="8.2. calendar — General calendar-related functions"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">Jython v2.5.2 documentation</a> &raquo;</li>
          <li><a href="indexprogress.html" >The Python Standard Library and What Comes with Jython</a> &raquo;</li>
          <li><a href="datatypes.html" accesskey="U">8. Data Types</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/jython.png" alt="Logo"/>
            </a></p>
            <h3><a href="../index.html">Table Of Contents</a></h3>
            <ul>
<li><a class="reference external" href="#">8.3. <tt class="docutils literal"><span class="pre">collections</span></tt> &#8212; High-performance container datatypes</a><ul>
<li><a class="reference external" href="#abcs-abstract-base-classes">8.3.1. ABCs - abstract base classes</a></li>
<li><a class="reference external" href="#deque-objects">8.3.2. <tt class="docutils literal"><span class="pre">deque</span></tt> objects</a><ul>
<li><a class="reference external" href="#deque-recipes">8.3.2.1. <tt class="docutils literal"><span class="pre">deque</span></tt> Recipes</a></li>
</ul>
</li>
<li><a class="reference external" href="#defaultdict-objects">8.3.3. <tt class="docutils literal"><span class="pre">defaultdict</span></tt> objects</a><ul>
<li><a class="reference external" href="#defaultdict-examples">8.3.3.1. <tt class="docutils literal"><span class="pre">defaultdict</span></tt> Examples</a></li>
</ul>
</li>
<li><a class="reference external" href="#namedtuple-factory-function-for-tuples-with-named-fields">8.3.4. <tt class="docutils literal"><span class="pre">namedtuple()</span></tt> Factory Function for Tuples with Named Fields</a></li>
</ul>
</li>
</ul>

            <h4>Previous topic</h4>
            <p class="topless"><a href="calendar.html"
                                  title="previous chapter">8.2. <tt class="docutils literal docutils literal"><span class="pre">calendar</span></tt> &#8212; General calendar-related functions</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="heapq.html"
                                  title="next chapter">8.4. <tt class="docutils literal docutils literal"><span class="pre">heapq</span></tt> &#8212; Heap queue algorithm</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="../_sources/library/collections.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="../search.html" method="get">
                <input type="text" name="q" size="18" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="collections-high-performance-container-datatypes">
<h1>8.3. <tt class="docutils literal"><span class="pre">collections</span></tt> &#8212; High-performance container datatypes<a class="headerlink" href="#collections-high-performance-container-datatypes" title="Permalink to this headline">¶</a></h1>
<p>New in version 2.4.</p>
<p>This module implements high-performance container datatypes.
Currently, there are two datatypes, <tt class="docutils literal"><span class="pre">deque</span></tt> and <tt class="docutils literal"><span class="pre">defaultdict</span></tt>, and
one datatype factory function, <tt class="docutils literal"><span class="pre">namedtuple()</span></tt>.</p>
<p>Changed in version 2.5: Added <tt class="docutils literal"><span class="pre">defaultdict</span></tt>.</p>
<p>Changed in version 2.6: Added <tt class="docutils literal"><span class="pre">namedtuple()</span></tt>.</p>
<p>The specialized containers provided in this module provide
alternatives to Python&#8217;s general purpose built-in containers,
<tt class="docutils literal"><span class="pre">dict</span></tt>, <tt class="docutils literal"><span class="pre">list</span></tt>, <tt class="docutils literal"><span class="pre">set</span></tt>, and <tt class="docutils literal"><span class="pre">tuple</span></tt>.</p>
<p>Besides the containers provided here, the optional <tt class="docutils literal"><span class="pre">bsddb</span></tt> module
offers the ability to create in-memory or file based ordered
dictionaries with string keys using the <tt class="docutils literal"><span class="pre">bsddb.btopen()</span></tt> method.</p>
<p>In addition to containers, the collections module provides some ABCs
(abstract base classes) that can be used to test whether a class
provides a particular interface, for example, is it hashable or a
mapping.</p>
<p>Changed in version 2.6: Added abstract base classes.</p>
<div class="section" id="abcs-abstract-base-classes">
<h2>8.3.1. ABCs - abstract base classes<a class="headerlink" href="#abcs-abstract-base-classes" title="Permalink to this headline">¶</a></h2>
<p>The collections module offers the following ABCs:</p>
<table border="1" class="docutils">
<colgroup>
<col width="21%" />
<col width="18%" />
<col width="19%" />
<col width="42%" />
</colgroup>
<thead valign="bottom">
<tr><th class="head">ABC</th>
<th class="head">Inherits</th>
<th class="head">Abstract Methods</th>
<th class="head">Mixin Methods</th>
</tr>
</thead>
<tbody valign="top">
<tr><td><tt class="docutils literal"><span class="pre">Container</span></tt></td>
<td>&nbsp;</td>
<td><tt class="docutils literal"><span class="pre">__contains__</span></tt></td>
<td>&nbsp;</td>
</tr>
<tr><td><tt class="docutils literal"><span class="pre">Hashable</span></tt></td>
<td>&nbsp;</td>
<td><tt class="docutils literal"><span class="pre">__hash__</span></tt></td>
<td>&nbsp;</td>
</tr>
<tr><td><tt class="docutils literal"><span class="pre">Iterable</span></tt></td>
<td>&nbsp;</td>
<td><tt class="docutils literal"><span class="pre">__iter__</span></tt></td>
<td>&nbsp;</td>
</tr>
<tr><td><tt class="docutils literal"><span class="pre">Iterator</span></tt></td>
<td><tt class="docutils literal"><span class="pre">Iterable</span></tt></td>
<td><tt class="docutils literal"><span class="pre">__next__</span></tt></td>
<td><tt class="docutils literal"><span class="pre">__iter__</span></tt></td>
</tr>
<tr><td><tt class="docutils literal"><span class="pre">Sized</span></tt></td>
<td>&nbsp;</td>
<td><tt class="docutils literal"><span class="pre">__len__</span></tt></td>
<td>&nbsp;</td>
</tr>
<tr><td><tt class="docutils literal"><span class="pre">Callable</span></tt></td>
<td>&nbsp;</td>
<td><tt class="docutils literal"><span class="pre">__call__</span></tt></td>
<td>&nbsp;</td>
</tr>
<tr><td><tt class="docutils literal"><span class="pre">Sequence</span></tt></td>
<td><tt class="docutils literal"><span class="pre">Sized</span></tt>,
<tt class="docutils literal"><span class="pre">Iterable</span></tt>,
<tt class="docutils literal"><span class="pre">Container</span></tt></td>
<td><tt class="docutils literal"><span class="pre">__getitem__</span></tt></td>
<td><tt class="docutils literal"><span class="pre">__contains__</span></tt>. <tt class="docutils literal"><span class="pre">__iter__</span></tt>, <tt class="docutils literal"><span class="pre">__reversed__</span></tt>.
<tt class="docutils literal"><span class="pre">index</span></tt>, and <tt class="docutils literal"><span class="pre">count</span></tt></td>
</tr>
<tr><td><tt class="docutils literal"><span class="pre">MutableSequence</span></tt></td>
<td><tt class="docutils literal"><span class="pre">Sequence</span></tt></td>
<td><tt class="docutils literal"><span class="pre">__setitem__</span></tt>
<tt class="docutils literal"><span class="pre">__delitem__</span></tt>, and
<tt class="docutils literal"><span class="pre">insert</span></tt></td>
<td>Inherited Sequence methods and <tt class="docutils literal"><span class="pre">append</span></tt>,
<tt class="docutils literal"><span class="pre">reverse</span></tt>, <tt class="docutils literal"><span class="pre">extend</span></tt>, <tt class="docutils literal"><span class="pre">pop</span></tt>, <tt class="docutils literal"><span class="pre">remove</span></tt>, and
<tt class="docutils literal"><span class="pre">__iadd__</span></tt></td>
</tr>
<tr><td><tt class="docutils literal"><span class="pre">Set</span></tt></td>
<td><tt class="docutils literal"><span class="pre">Sized</span></tt>,
<tt class="docutils literal"><span class="pre">Iterable</span></tt>,
<tt class="docutils literal"><span class="pre">Container</span></tt></td>
<td>&nbsp;</td>
<td><tt class="docutils literal"><span class="pre">__le__</span></tt>, <tt class="docutils literal"><span class="pre">__lt__</span></tt>, <tt class="docutils literal"><span class="pre">__eq__</span></tt>, <tt class="docutils literal"><span class="pre">__ne__</span></tt>,
<tt class="docutils literal"><span class="pre">__gt__</span></tt>, <tt class="docutils literal"><span class="pre">__ge__</span></tt>, <tt class="docutils literal"><span class="pre">__and__</span></tt>, <tt class="docutils literal"><span class="pre">__or__</span></tt>
<tt class="docutils literal"><span class="pre">__sub__</span></tt>, <tt class="docutils literal"><span class="pre">__xor__</span></tt>, and <tt class="docutils literal"><span class="pre">isdisjoint</span></tt></td>
</tr>
<tr><td><tt class="docutils literal"><span class="pre">MutableSet</span></tt></td>
<td><tt class="docutils literal"><span class="pre">Set</span></tt></td>
<td><tt class="docutils literal"><span class="pre">add</span></tt> and
<tt class="docutils literal"><span class="pre">discard</span></tt></td>
<td>Inherited Set methods and <tt class="docutils literal"><span class="pre">clear</span></tt>, <tt class="docutils literal"><span class="pre">pop</span></tt>,
<tt class="docutils literal"><span class="pre">remove</span></tt>, <tt class="docutils literal"><span class="pre">__ior__</span></tt>, <tt class="docutils literal"><span class="pre">__iand__</span></tt>, <tt class="docutils literal"><span class="pre">__ixor__</span></tt>,
and <tt class="docutils literal"><span class="pre">__isub__</span></tt></td>
</tr>
<tr><td><tt class="docutils literal"><span class="pre">Mapping</span></tt></td>
<td><tt class="docutils literal"><span class="pre">Sized</span></tt>,
<tt class="docutils literal"><span class="pre">Iterable</span></tt>,
<tt class="docutils literal"><span class="pre">Container</span></tt></td>
<td><tt class="docutils literal"><span class="pre">__getitem__</span></tt></td>
<td><tt class="docutils literal"><span class="pre">__contains__</span></tt>, <tt class="docutils literal"><span class="pre">keys</span></tt>, <tt class="docutils literal"><span class="pre">items</span></tt>, <tt class="docutils literal"><span class="pre">values</span></tt>,
<tt class="docutils literal"><span class="pre">get</span></tt>, <tt class="docutils literal"><span class="pre">__eq__</span></tt>, and <tt class="docutils literal"><span class="pre">__ne__</span></tt></td>
</tr>
<tr><td><tt class="docutils literal"><span class="pre">MutableMapping</span></tt></td>
<td><tt class="docutils literal"><span class="pre">Mapping</span></tt></td>
<td><tt class="docutils literal"><span class="pre">__setitem__</span></tt> and
<tt class="docutils literal"><span class="pre">__delitem__</span></tt></td>
<td>Inherited Mapping methods and <tt class="docutils literal"><span class="pre">pop</span></tt>, <tt class="docutils literal"><span class="pre">popitem</span></tt>,
<tt class="docutils literal"><span class="pre">clear</span></tt>, <tt class="docutils literal"><span class="pre">update</span></tt>, and <tt class="docutils literal"><span class="pre">setdefault</span></tt></td>
</tr>
<tr><td><tt class="docutils literal"><span class="pre">MappingView</span></tt></td>
<td><tt class="docutils literal"><span class="pre">Sized</span></tt></td>
<td>&nbsp;</td>
<td><tt class="docutils literal"><span class="pre">__len__</span></tt></td>
</tr>
<tr><td><tt class="docutils literal"><span class="pre">KeysView</span></tt></td>
<td><tt class="docutils literal"><span class="pre">MappingView</span></tt>,
<tt class="docutils literal"><span class="pre">Set</span></tt></td>
<td>&nbsp;</td>
<td><tt class="docutils literal"><span class="pre">__contains__</span></tt>, <tt class="docutils literal"><span class="pre">__iter__</span></tt></td>
</tr>
<tr><td><tt class="docutils literal"><span class="pre">ItemsView</span></tt></td>
<td><tt class="docutils literal"><span class="pre">MappingView</span></tt>,
<tt class="docutils literal"><span class="pre">Set</span></tt></td>
<td>&nbsp;</td>
<td><tt class="docutils literal"><span class="pre">__contains__</span></tt>, <tt class="docutils literal"><span class="pre">__iter__</span></tt></td>
</tr>
<tr><td><tt class="docutils literal"><span class="pre">ValuesView</span></tt></td>
<td><tt class="docutils literal"><span class="pre">MappingView</span></tt></td>
<td>&nbsp;</td>
<td><tt class="docutils literal"><span class="pre">__contains__</span></tt>, <tt class="docutils literal"><span class="pre">__iter__</span></tt></td>
</tr>
</tbody>
</table>
<p>These ABCs allow us to ask classes or instances if they provide
particular functionality, for example:</p>
<blockquote>
<p>size = None
if isinstance(myvar, collections.Sized):</p>
<blockquote>
size = len(myvar)</blockquote>
</blockquote>
<p>Several of the ABCs are also useful as mixins that make it easier to
develop classes supporting container APIs.  For example, to write a
class supporting the full <tt class="docutils literal"><span class="pre">Set</span></tt> API, it only necessary to supply the
three underlying abstract methods: <tt class="docutils literal"><span class="pre">__contains__()</span></tt>, <tt class="docutils literal"><span class="pre">__iter__()</span></tt>,
and <tt class="docutils literal"><span class="pre">__len__()</span></tt>. The ABC supplies the remaining methods such as
<tt class="docutils literal"><span class="pre">__and__()</span></tt> and <tt class="docutils literal"><span class="pre">isdisjoint()</span></tt></p>
<blockquote>
<dl class="docutils">
<dt>class ListBasedSet(collections.Set):</dt>
<dd><dl class="first last docutils">
<dt>&#8216;&#8217;&#8217; Alternate set implementation favoring space over speed</dt>
<dd>and not requiring the set elements to be hashable. &#8216;&#8217;&#8216;</dd>
<dt>def __init__(self, iterable):</dt>
<dd><p class="first">self.elements = lst = []
for value in iterable:</p>
<blockquote class="last">
<dl class="docutils">
<dt>if value not in lst:</dt>
<dd>lst.append(value)</dd>
</dl>
</blockquote>
</dd>
<dt>def __iter__(self):</dt>
<dd>return iter(self.elements)</dd>
<dt>def __contains__(self, value):</dt>
<dd>return value in self.elements</dd>
<dt>def __len__(self):</dt>
<dd>return len(self.elements)</dd>
</dl>
</dd>
</dl>
<p>s1 = ListBasedSet(&#8216;abcdef&#8217;)
s2 = ListBasedSet(&#8216;defghi&#8217;)
overlap = s1 &amp; s2            # The __and__() method is supported automatically</p>
</blockquote>
<p>Notes on using <tt class="docutils literal"><span class="pre">Set</span></tt> and <tt class="docutils literal"><span class="pre">MutableSet</span></tt> as a mixin:</p>
<ol class="arabic simple">
<li>Since some set operations create new sets, the default mixin
methods need a way to create new instances from an iterable. The
class constructor is assumed to have a signature in the form
<tt class="docutils literal"><span class="pre">ClassName(iterable)</span></tt>. That assumption is factored-out to an
internal classmethod called <tt class="docutils literal"><span class="pre">_from_iterable()</span></tt> which calls
<tt class="docutils literal"><span class="pre">cls(iterable)</span></tt> to produce a new set. If the <tt class="docutils literal"><span class="pre">Set</span></tt> mixin is
being used in a class with a different constructor signature, you
will need to override <tt class="docutils literal"><span class="pre">from_iterable()</span></tt> with a classmethod that
can construct new instances from an iterable argument.</li>
<li>To override the comparisons (presumably for speed, as the semantics
are fixed), redefine <tt class="docutils literal"><span class="pre">__le__()</span></tt> and then the other operations
will automatically follow suit.</li>
<li>The <tt class="docutils literal"><span class="pre">Set</span></tt> mixin provides a <tt class="docutils literal"><span class="pre">_hash()</span></tt> method to compute a hash
value for the set; however, <tt class="docutils literal"><span class="pre">__hash__()</span></tt> is not defined because
not all sets are hashable or immutable.  To add set hashabilty
using mixins, inherit from both <tt class="docutils literal"><span class="pre">Set()</span></tt> and <tt class="docutils literal"><span class="pre">Hashable()</span></tt>, then
define <tt class="docutils literal"><span class="pre">__hash__</span> <span class="pre">=</span> <span class="pre">Set._hash</span></tt>.</li>
</ol>
<p>See also:</p>
<blockquote>
<ul class="simple">
<li>OrderedSet recipe for an example built on <tt class="docutils literal"><span class="pre">MutableSet</span></tt>.</li>
<li>For more about ABCs, see the <tt class="docutils literal"><span class="pre">abc</span></tt> module and <strong>PEP 3119</strong>.</li>
</ul>
</blockquote>
</div>
<div class="section" id="deque-objects">
<h2>8.3.2. <tt class="docutils literal"><span class="pre">deque</span></tt> objects<a class="headerlink" href="#deque-objects" title="Permalink to this headline">¶</a></h2>
<p>class class collections.deque([iterable[, maxlen]])</p>
<blockquote>
<p>Returns a new deque object initialized left-to-right (using
<tt class="docutils literal"><span class="pre">append()</span></tt>) with data from <em>iterable</em>.  If <em>iterable</em> is not
specified, the new deque is empty.</p>
<p>Deques are a generalization of stacks and queues (the name is
pronounced &#8220;deck&#8221; and is short for &#8220;double-ended queue&#8221;).  Deques
support thread-safe, memory efficient appends and pops from either
side of the deque with approximately the same O(1) performance in
either direction.</p>
<p>Though <tt class="docutils literal"><span class="pre">list</span></tt> objects support similar operations, they are
optimized for fast fixed-length operations and incur O(n) memory
movement costs for <tt class="docutils literal"><span class="pre">pop(0)</span></tt> and <tt class="docutils literal"><span class="pre">insert(0,</span> <span class="pre">v)</span></tt> operations which
change both the size and position of the underlying data
representation.</p>
<p>New in version 2.4.</p>
<p>If <em>maxlen</em> is not specified or is <em>None</em>, deques may grow to an
arbitrary length.  Otherwise, the deque is bounded to the specified
maximum length.  Once a bounded length deque is full, when new
items are added, a corresponding number of items are discarded from
the opposite end.  Bounded length deques provide functionality
similar to the <tt class="docutils literal"><span class="pre">tail</span></tt> filter in Unix. They are also useful for
tracking transactions and other pools of data where only the most
recent activity is of interest.</p>
<p>Changed in version 2.6: Added <em>maxlen</em> parameter.</p>
<p>Deque objects support the following methods:</p>
<p>append(x)</p>
<blockquote>
Add <em>x</em> to the right side of the deque.</blockquote>
<p>appendleft(x)</p>
<blockquote>
Add <em>x</em> to the left side of the deque.</blockquote>
<p>clear()</p>
<blockquote>
Remove all elements from the deque leaving it with length 0.</blockquote>
<p>extend(iterable)</p>
<blockquote>
Extend the right side of the deque by appending elements from
the iterable argument.</blockquote>
<p>extendleft(iterable)</p>
<blockquote>
Extend the left side of the deque by appending elements from
<em>iterable</em>. Note, the series of left appends results in
reversing the order of elements in the iterable argument.</blockquote>
<p>pop()</p>
<blockquote>
Remove and return an element from the right side of the deque.
If no elements are present, raises an <tt class="docutils literal"><span class="pre">IndexError</span></tt>.</blockquote>
<p>popleft()</p>
<blockquote>
Remove and return an element from the left side of the deque. If
no elements are present, raises an <tt class="docutils literal"><span class="pre">IndexError</span></tt>.</blockquote>
<p>remove(value)</p>
<blockquote>
<p>Removed the first occurrence of <em>value</em>.  If not found, raises a
<tt class="docutils literal"><span class="pre">ValueError</span></tt>.</p>
<p>New in version 2.5.</p>
</blockquote>
<p>rotate(n)</p>
<blockquote>
Rotate the deque <em>n</em> steps to the right.  If <em>n</em> is negative,
rotate to the left.  Rotating one step to the right is
equivalent to: <tt class="docutils literal"><span class="pre">d.appendleft(d.pop())</span></tt>.</blockquote>
</blockquote>
<p>In addition to the above, deques support iteration, pickling,
<tt class="docutils literal"><span class="pre">len(d)</span></tt>, <tt class="docutils literal"><span class="pre">reversed(d)</span></tt>, <tt class="docutils literal"><span class="pre">copy.copy(d)</span></tt>, <tt class="docutils literal"><span class="pre">copy.deepcopy(d)</span></tt>,
membership testing with the <tt class="docutils literal"><span class="pre">in</span></tt> operator, and subscript references
such as <tt class="docutils literal"><span class="pre">d[-1]</span></tt>.  Indexed access is O(1) at both ends but slows to
O(n) in the middle.  For fast random access, use lists instead.</p>
<p>Example:</p>
<blockquote>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">deque</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">deque</span><span class="p">(</span><span class="s">&#39;ghi&#39;</span><span class="p">)</span>                 <span class="c"># make a new deque with three items</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">d</span><span class="p">:</span>                   <span class="c"># iterate over the deque&#39;s elements</span>
<span class="gp">... </span>    <span class="k">print</span> <span class="n">elem</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
<span class="go">G</span>
<span class="go">H</span>
<span class="go">I</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&#39;j&#39;</span><span class="p">)</span>                    <span class="c"># add a new entry to the right side</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">appendleft</span><span class="p">(</span><span class="s">&#39;f&#39;</span><span class="p">)</span>                <span class="c"># add a new entry to the left side</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span>                                <span class="c"># show the representation of the deque</span>
<span class="go">deque([&#39;f&#39;, &#39;g&#39;, &#39;h&#39;, &#39;i&#39;, &#39;j&#39;])</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>                          <span class="c"># return and remove the rightmost item</span>
<span class="go">&#39;j&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">popleft</span><span class="p">()</span>                      <span class="c"># return and remove the leftmost item</span>
<span class="go">&#39;f&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>                          <span class="c"># list the contents of the deque</span>
<span class="go">[&#39;g&#39;, &#39;h&#39;, &#39;i&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>                             <span class="c"># peek at leftmost item</span>
<span class="go">&#39;g&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>                            <span class="c"># peek at rightmost item</span>
<span class="go">&#39;i&#39;</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="n">d</span><span class="p">))</span>                <span class="c"># list the contents of a deque in reverse</span>
<span class="go">[&#39;i&#39;, &#39;h&#39;, &#39;g&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s">&#39;h&#39;</span> <span class="ow">in</span> <span class="n">d</span>                         <span class="c"># search the deque</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="s">&#39;jkl&#39;</span><span class="p">)</span>                  <span class="c"># add multiple elements at once</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span>
<span class="go">deque([&#39;g&#39;, &#39;h&#39;, &#39;i&#39;, &#39;j&#39;, &#39;k&#39;, &#39;l&#39;])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>                      <span class="c"># right rotation</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span>
<span class="go">deque([&#39;l&#39;, &#39;g&#39;, &#39;h&#39;, &#39;i&#39;, &#39;j&#39;, &#39;k&#39;])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>                     <span class="c"># left rotation</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span>
<span class="go">deque([&#39;g&#39;, &#39;h&#39;, &#39;i&#39;, &#39;j&#39;, &#39;k&#39;, &#39;l&#39;])</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">deque</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="n">d</span><span class="p">))</span>               <span class="c"># make a new deque in reverse order</span>
<span class="go">deque([&#39;l&#39;, &#39;k&#39;, &#39;j&#39;, &#39;i&#39;, &#39;h&#39;, &#39;g&#39;])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>                        <span class="c"># empty the deque</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>                          <span class="c"># cannot pop from an empty deque</span>
<span class="gt">Traceback (most recent call last):</span>
  File <span class="nb">&quot;&lt;pyshell#6&gt;&quot;</span>, line <span class="m">1</span>, in <span class="n-Identifier">-toplevel-</span>
    <span class="n">d</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
<span class="nc">IndexError</span>: <span class="n-Identifier">pop from an empty deque</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">extendleft</span><span class="p">(</span><span class="s">&#39;abc&#39;</span><span class="p">)</span>              <span class="c"># extendleft() reverses the input order</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span>
<span class="go">deque([&#39;c&#39;, &#39;b&#39;, &#39;a&#39;])</span>
</pre></div>
</div>
</blockquote>
<div class="section" id="deque-recipes">
<h3>8.3.2.1. <tt class="docutils literal"><span class="pre">deque</span></tt> Recipes<a class="headerlink" href="#deque-recipes" title="Permalink to this headline">¶</a></h3>
<p>This section shows various approaches to working with deques.</p>
<p>Bounded length deques provide functionality similar to the <tt class="docutils literal"><span class="pre">tail</span></tt>
filter in Unix:</p>
<blockquote>
<dl class="docutils">
<dt>def tail(filename, n=10):</dt>
<dd>&#8216;Return the last n lines of a file&#8217;
return deque(open(filename), n)</dd>
</dl>
</blockquote>
<p>Another approach to using deques is to maintain a sequence of recently
added elements by appending to the right and popping to the left:</p>
<blockquote>
<dl class="docutils">
<dt>def moving_average(iterable, n=3):</dt>
<dd><p class="first"># moving_average([40, 30, 50, 46, 39, 44]) &#8211;&gt; 40.0 42.0 45.0 43.0
# <a class="reference external" href="http://en.wikipedia.org/wiki/Moving_average">http://en.wikipedia.org/wiki/Moving_average</a>
it = iter(iterable)
d = deque(itertools.islice(it, n-1))
d.appendleft(0)
s = sum(d)
for elem in it:</p>
<blockquote class="last">
s += elem - d.popleft()
d.append(elem)
yield s / float(n)</blockquote>
</dd>
</dl>
</blockquote>
<p>The <tt class="docutils literal"><span class="pre">rotate()</span></tt> method provides a way to implement <tt class="docutils literal"><span class="pre">deque</span></tt> slicing
and deletion.  For example, a pure python implementation of <tt class="docutils literal"><span class="pre">del</span>
<span class="pre">d[n]</span></tt> relies on the <tt class="docutils literal"><span class="pre">rotate()</span></tt> method to position elements to be
popped:</p>
<blockquote>
<dl class="docutils">
<dt>def delete_nth(d, n):</dt>
<dd>d.rotate(-n)
d.popleft()
d.rotate(n)</dd>
</dl>
</blockquote>
<p>To implement <tt class="docutils literal"><span class="pre">deque</span></tt> slicing, use a similar approach applying
<tt class="docutils literal"><span class="pre">rotate()</span></tt> to bring a target element to the left side of the deque.
Remove old entries with <tt class="docutils literal"><span class="pre">popleft()</span></tt>, add new entries with
<tt class="docutils literal"><span class="pre">extend()</span></tt>, and then reverse the rotation. With minor variations on
that approach, it is easy to implement Forth style stack manipulations
such as <tt class="docutils literal"><span class="pre">dup</span></tt>, <tt class="docutils literal"><span class="pre">drop</span></tt>, <tt class="docutils literal"><span class="pre">swap</span></tt>, <tt class="docutils literal"><span class="pre">over</span></tt>, <tt class="docutils literal"><span class="pre">pick</span></tt>, <tt class="docutils literal"><span class="pre">rot</span></tt>, and
<tt class="docutils literal"><span class="pre">roll</span></tt>.</p>
</div>
</div>
<div class="section" id="defaultdict-objects">
<h2>8.3.3. <tt class="docutils literal"><span class="pre">defaultdict</span></tt> objects<a class="headerlink" href="#defaultdict-objects" title="Permalink to this headline">¶</a></h2>
<p>class class collections.defaultdict([default_factory[, ...]])</p>
<blockquote>
<p>Returns a new dictionary-like object.  <tt class="docutils literal"><span class="pre">defaultdict</span></tt> is a
subclass of the builtin <tt class="docutils literal"><span class="pre">dict</span></tt> class.  It overrides one method
and adds one writable instance variable.  The remaining
functionality is the same as for the <tt class="docutils literal"><span class="pre">dict</span></tt> class and is not
documented here.</p>
<p>The first argument provides the initial value for the
<tt class="docutils literal"><span class="pre">default_factory</span></tt> attribute; it defaults to <tt class="xref docutils literal"><span class="pre">None</span></tt>. All
remaining arguments are treated the same as if they were passed to
the <tt class="docutils literal"><span class="pre">dict</span></tt> constructor, including keyword arguments.</p>
<p>New in version 2.5.</p>
<p><tt class="docutils literal"><span class="pre">defaultdict</span></tt> objects support the following method in addition to
the standard <tt class="docutils literal"><span class="pre">dict</span></tt> operations:</p>
<p>__missing__(key)</p>
<blockquote>
<p>If the <tt class="docutils literal"><span class="pre">default_factory</span></tt> attribute is <tt class="xref docutils literal"><span class="pre">None</span></tt>, this raises a
<tt class="docutils literal"><span class="pre">KeyError</span></tt> exception with the <em>key</em> as argument.</p>
<p>If <tt class="docutils literal"><span class="pre">default_factory</span></tt> is not <tt class="xref docutils literal"><span class="pre">None</span></tt>, it is called without
arguments to provide a default value for the given <em>key</em>, this
value is inserted in the dictionary for the <em>key</em>, and returned.</p>
<p>If calling <tt class="docutils literal"><span class="pre">default_factory</span></tt> raises an exception this
exception is propagated unchanged.</p>
<p>This method is called by the <tt class="docutils literal"><span class="pre">__getitem__()</span></tt> method of the
<tt class="docutils literal"><span class="pre">dict</span></tt> class when the requested key is not found; whatever it
returns or raises is then returned or raised by
<tt class="docutils literal"><span class="pre">__getitem__()</span></tt>.</p>
</blockquote>
<p><tt class="docutils literal"><span class="pre">defaultdict</span></tt> objects support the following instance variable:</p>
<p>default_factory</p>
<blockquote>
This attribute is used by the <tt class="docutils literal"><span class="pre">__missing__()</span></tt> method; it is
initialized from the first argument to the constructor, if
present, or to <tt class="xref docutils literal"><span class="pre">None</span></tt>, if absent.</blockquote>
</blockquote>
<div class="section" id="defaultdict-examples">
<h3>8.3.3.1. <tt class="docutils literal"><span class="pre">defaultdict</span></tt> Examples<a class="headerlink" href="#defaultdict-examples" title="Permalink to this headline">¶</a></h3>
<p>Using <tt class="docutils literal"><span class="pre">list</span></tt> as the <tt class="docutils literal"><span class="pre">default_factory</span></tt>, it is easy to group a
sequence of key-value pairs into a dictionary of lists:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="p">[(</span><span class="s">&#39;yellow&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;blue&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;yellow&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;blue&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;red&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">s</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">d</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
<span class="go">[(&#39;blue&#39;, [2, 4]), (&#39;red&#39;, [1]), (&#39;yellow&#39;, [1, 3])]</span>
</pre></div>
</div>
<p>When each key is encountered for the first time, it is not already in
the mapping; so an entry is automatically created using the
<tt class="docutils literal"><span class="pre">default_factory</span></tt> function which returns an empty <tt class="docutils literal"><span class="pre">list</span></tt>.  The
<tt class="docutils literal"><span class="pre">list.append()</span></tt> operation then attaches the value to the new list.
When keys are encountered again, the look-up proceeds normally
(returning the list for that key) and the <tt class="docutils literal"><span class="pre">list.append()</span></tt> operation
adds another value to the list. This technique is simpler and faster
than an equivalent technique using <tt class="docutils literal"><span class="pre">dict.setdefault()</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="p">{}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">s</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">d</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="p">[])</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
<span class="go">[(&#39;blue&#39;, [2, 4]), (&#39;red&#39;, [1]), (&#39;yellow&#39;, [1, 3])]</span>
</pre></div>
</div>
<p>Setting the <tt class="docutils literal"><span class="pre">default_factory</span></tt> to <tt class="docutils literal"><span class="pre">int</span></tt> makes the <tt class="docutils literal"><span class="pre">defaultdict</span></tt>
useful for counting (like a bag or multiset in other languages):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="s">&#39;mississippi&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">s</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">d</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
<span class="go">[(&#39;i&#39;, 4), (&#39;p&#39;, 2), (&#39;s&#39;, 4), (&#39;m&#39;, 1)]</span>
</pre></div>
</div>
<p>When a letter is first encountered, it is missing from the mapping, so
the <tt class="docutils literal"><span class="pre">default_factory</span></tt> function calls <tt class="docutils literal"><span class="pre">int()</span></tt> to supply a default
count of zero.  The increment operation then builds up the count for
each letter.</p>
<p>The function <tt class="docutils literal"><span class="pre">int()</span></tt> which always returns zero is just a special
case of constant functions.  A faster and more flexible way to create
constant functions is to use <tt class="docutils literal"><span class="pre">itertools.repeat()</span></tt> which can supply
any constant value (not just zero):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">constant_factory</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">itertools</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="n">next</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="n">constant_factory</span><span class="p">(</span><span class="s">&#39;&lt;missing&gt;&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&#39;John&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s">&#39;ran&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s">&#39;</span><span class="si">%(name)s</span><span class="s"> </span><span class="si">%(action)s</span><span class="s"> to </span><span class="si">%(object)s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">d</span>
<span class="go">&#39;John ran to &lt;missing&gt;&#39;</span>
</pre></div>
</div>
<p>Setting the <tt class="docutils literal"><span class="pre">default_factory</span></tt> to <tt class="docutils literal"><span class="pre">set</span></tt> makes the <tt class="docutils literal"><span class="pre">defaultdict</span></tt>
useful for building a dictionary of sets:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="p">[(</span><span class="s">&#39;red&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;blue&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;red&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;blue&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;red&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;blue&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">set</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">s</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">d</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
<span class="go">[(&#39;blue&#39;, set([2, 4])), (&#39;red&#39;, set([1, 3]))]</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="namedtuple-factory-function-for-tuples-with-named-fields">
<h2>8.3.4. <tt class="docutils literal"><span class="pre">namedtuple()</span></tt> Factory Function for Tuples with Named Fields<a class="headerlink" href="#namedtuple-factory-function-for-tuples-with-named-fields" title="Permalink to this headline">¶</a></h2>
<p>Named tuples assign meaning to each position in a tuple and allow for
more readable, self-documenting code.  They can be used wherever
regular tuples are used, and they add the ability to access fields by
name instead of position index.</p>
<p>collections.namedtuple(typename, field_names[, verbose])</p>
<blockquote>
<p>Returns a new tuple subclass named <em>typename</em>.  The new subclass is
used to create tuple-like objects that have fields accessible by
attribute lookup as well as being indexable and iterable.
Instances of the subclass also have a helpful docstring (with
typename and field_names) and a helpful <tt class="docutils literal"><span class="pre">__repr__()</span></tt> method which
lists the tuple contents in a <tt class="docutils literal"><span class="pre">name=value</span></tt> format.</p>
<p>The <em>field_names</em> are a single string with each fieldname separated
by whitespace and/or commas, for example <tt class="docutils literal"><span class="pre">'x</span> <span class="pre">y'</span></tt> or <tt class="docutils literal"><span class="pre">'x,</span> <span class="pre">y'</span></tt>.
Alternatively, <em>field_names</em> can be a sequence of strings such as
<tt class="docutils literal"><span class="pre">['x',</span> <span class="pre">'y']</span></tt>.</p>
<p>Any valid Python identifier may be used for a fieldname except for
names starting with an underscore.  Valid identifiers consist of
letters, digits, and underscores but do not start with a digit or
underscore and cannot be a <tt class="docutils literal"><span class="pre">keyword</span></tt> such as <em>class</em>, <em>for</em>,
<em>return</em>, <em>global</em>, <em>pass</em>, <em>print</em>, or <em>raise</em>.</p>
<p>If <em>verbose</em> is true, the class definition is printed just before
being built.</p>
<p>Named tuple instances do not have per-instance dictionaries, so
they are lightweight and require no more memory than regular
tuples.</p>
<p>New in version 2.6.</p>
</blockquote>
<p>Example:</p>
<blockquote>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">Point</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s">&#39;Point&#39;</span><span class="p">,</span> <span class="s">&#39;x y&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">class Point(tuple):</span>
<span class="go">        &#39;Point(x, y)&#39;</span>
</pre></div>
</div>
<blockquote>
<p>__slots__ = ()</p>
<p>_fields = (&#8216;x&#8217;, &#8216;y&#8217;)</p>
<dl class="docutils">
<dt>def __new__(_cls, x, y):</dt>
<dd>return _tuple.__new__(_cls, (x, y))</dd>
</dl>
<p>&#64;classmethod
def _make(cls, iterable, new=tuple.__new__, len=len):</p>
<blockquote>
<p>&#8216;Make a new Point object from a sequence or iterable&#8217;
result = new(cls, iterable)
if len(result) != 2:</p>
<blockquote>
raise TypeError(&#8216;Expected 2 arguments, got %d&#8217; % len(result))</blockquote>
<p>return result</p>
</blockquote>
<dl class="docutils">
<dt>def __repr__(self):</dt>
<dd>return &#8216;Point(x=%r, y=%r)&#8217; % self</dd>
<dt>def _asdict(t):</dt>
<dd>&#8216;Return a new dict which maps field names to their values&#8217;
return {&#8216;x&#8217;: t[0], &#8216;y&#8217;: t[1]}</dd>
<dt>def _replace(_self, <a href="#id1"><span class="problematic" id="id2">**</span></a>kwds):</dt>
<dd><p class="first">&#8216;Return a new Point object replacing specified fields with new values&#8217;
result = _self._make(map(kwds.pop, (&#8216;x&#8217;, &#8216;y&#8217;), _self))
if kwds:</p>
<blockquote>
raise ValueError(&#8216;Got unexpected field names: %r&#8217; % kwds.keys())</blockquote>
<p class="last">return result</p>
</dd>
<dt>def __getnewargs__(self):</dt>
<dd>return tuple(self)</dd>
</dl>
<p>x = _property(_itemgetter(0))
y = _property(_itemgetter(1))</p>
</blockquote>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">22</span><span class="p">)</span>     <span class="c"># instantiate with positional or keyword arguments</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>             <span class="c"># indexable like the plain tuple (11, 22)</span>
<span class="go">33</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">p</span>                <span class="c"># unpack like a regular tuple</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span>
<span class="go">(11, 22)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="n">p</span><span class="o">.</span><span class="n">y</span>               <span class="c"># fields also accessible by name</span>
<span class="go">33</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span>                       <span class="c"># readable __repr__ with a name=value style</span>
<span class="go">Point(x=11, y=22)</span>
</pre></div>
</div>
</blockquote>
<p>Named tuples are especially useful for assigning field names to result
tuples returned by the <tt class="docutils literal"><span class="pre">csv</span></tt> or <tt class="docutils literal"><span class="pre">sqlite3</span></tt> modules:</p>
<blockquote>
<p>EmployeeRecord = namedtuple(&#8216;EmployeeRecord&#8217;, &#8216;name, age, title, department, paygrade&#8217;)</p>
<p>import csv
for emp in map(EmployeeRecord._make, csv.reader(open(&#8220;employees.csv&#8221;, &#8220;rb&#8221;))):</p>
<blockquote>
print emp.name, emp.title</blockquote>
<p>import sqlite3
conn = sqlite3.connect(&#8216;/companydata&#8217;)
cursor = conn.cursor()
cursor.execute(&#8216;SELECT name, age, title, department, paygrade FROM employees&#8217;)
for emp in map(EmployeeRecord._make, cursor.fetchall()):</p>
<blockquote>
print emp.name, emp.title</blockquote>
</blockquote>
<p>In addition to the methods inherited from tuples, named tuples support
three additional methods and one attribute.  To prevent conflicts with
field names, the method and attribute names start with an underscore.</p>
<p>somenamedtuple._make(iterable)</p>
<blockquote>
<p>Class method that makes a new instance from an existing sequence or
iterable.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="p">[</span><span class="mi">11</span><span class="p">,</span> <span class="mi">22</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Point</span><span class="o">.</span><span class="n">_make</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="go">Point(x=11, y=22)</span>
</pre></div>
</div>
</blockquote>
<p>somenamedtuple._asdict()</p>
<blockquote>
<p>Return a new dict which maps field names to their corresponding
values:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">_asdict</span><span class="p">()</span>
<span class="go">{&#39;x&#39;: 11, &#39;y&#39;: 22}</span>
</pre></div>
</div>
</blockquote>
<p>somenamedtuple._replace(kwargs)</p>
<blockquote>
<p>Return a new instance of the named tuple replacing specified fields
with new values:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">22</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">_replace</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">33</span><span class="p">)</span>
<span class="go">Point(x=33, y=22)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">partnum</span><span class="p">,</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">inventory</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<span class="gp">... </span>    <span class="n">inventory</span><span class="p">[</span><span class="n">partnum</span><span class="p">]</span> <span class="o">=</span> <span class="n">record</span><span class="o">.</span><span class="n">_replace</span><span class="p">(</span><span class="n">price</span><span class="o">=</span><span class="n">newprices</span><span class="p">[</span><span class="n">partnum</span><span class="p">],</span> <span class="n">timestamp</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">now</span><span class="p">())</span>
</pre></div>
</div>
</blockquote>
<p>somenamedtuple._fields</p>
<blockquote>
<p>Tuple of strings listing the field names.  Useful for introspection
and for creating new named tuple types from existing named tuples.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">_fields</span>            <span class="c"># view the field names</span>
<span class="go">(&#39;x&#39;, &#39;y&#39;)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">Color</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s">&#39;Color&#39;</span><span class="p">,</span> <span class="s">&#39;red green blue&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Pixel</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s">&#39;Pixel&#39;</span><span class="p">,</span> <span class="n">Point</span><span class="o">.</span><span class="n">_fields</span> <span class="o">+</span> <span class="n">Color</span><span class="o">.</span><span class="n">_fields</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Pixel</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">Pixel(x=11, y=22, red=128, green=255, blue=0)</span>
</pre></div>
</div>
</blockquote>
<p>To retrieve a field whose name is stored in a string, use the
<tt class="docutils literal"><span class="pre">getattr()</span></tt> function:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="nb">getattr</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="s">&#39;x&#39;</span><span class="p">)</span>
<span class="go">11</span>
</pre></div>
</div>
<p>To convert a dictionary to a named tuple, use the double-star-operator
(as described in <em>Unpacking Argument Lists</em>):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;x&#39;</span><span class="p">:</span> <span class="mi">11</span><span class="p">,</span> <span class="s">&#39;y&#39;</span><span class="p">:</span> <span class="mi">22</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Point</span><span class="p">(</span><span class="o">**</span><span class="n">d</span><span class="p">)</span>
<span class="go">Point(x=11, y=22)</span>
</pre></div>
</div>
<p>Since a named tuple is a regular Python class, it is easy to add or
change functionality with a subclass.  Here is how to add a calculated
field and a fixed-width print format:</p>
<blockquote>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Point</span><span class="p">(</span><span class="n">namedtuple</span><span class="p">(</span><span class="s">&#39;Point&#39;</span><span class="p">,</span> <span class="s">&#39;x y&#39;</span><span class="p">)):</span>
<span class="gp">... </span>    <span class="n">__slots__</span> <span class="o">=</span> <span class="p">()</span>
<span class="gp">... </span>    <span class="nd">@property</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">hypot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="s">&#39;Point: x=</span><span class="si">%6.3f</span><span class="s">  y=</span><span class="si">%6.3f</span><span class="s">  hypot=</span><span class="si">%6.3f</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">hypot</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">Point</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">Point</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">5</span><span class="o">/</span><span class="mf">7.</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">print</span> <span class="n">p</span>
<span class="go">Point: x= 3.000  y= 4.000  hypot= 5.000</span>
<span class="go">Point: x=14.000  y= 0.714  hypot=14.018</span>
</pre></div>
</div>
</blockquote>
<p>The subclass shown above sets <tt class="docutils literal"><span class="pre">__slots__</span></tt> to an empty tuple.  This
keeps keep memory requirements low by preventing the creation of
instance dictionaries.</p>
<p>Subclassing is not useful for adding new, stored fields.  Instead,
simply create a new named tuple type from the <tt class="docutils literal"><span class="pre">_fields</span></tt> attribute:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">Point3D</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s">&#39;Point3D&#39;</span><span class="p">,</span> <span class="n">Point</span><span class="o">.</span><span class="n">_fields</span> <span class="o">+</span> <span class="p">(</span><span class="s">&#39;z&#39;</span><span class="p">,))</span>
</pre></div>
</div>
<p>Default values can be implemented by using <tt class="docutils literal"><span class="pre">_replace()</span></tt> to customize
a prototype instance:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">Account</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s">&#39;Account&#39;</span><span class="p">,</span> <span class="s">&#39;owner balance transaction_count&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">default_account</span> <span class="o">=</span> <span class="n">Account</span><span class="p">(</span><span class="s">&#39;&lt;owner name&gt;&#39;</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">johns_account</span> <span class="o">=</span> <span class="n">default_account</span><span class="o">.</span><span class="n">_replace</span><span class="p">(</span><span class="n">owner</span><span class="o">=</span><span class="s">&#39;John&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Enumerated constants can be implemented with named tuples, but it is
simpler and more efficient to use a simple class declaration:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">Status</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s">&#39;Status&#39;</span><span class="p">,</span> <span class="s">&#39;open pending closed&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">_make</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Status</span><span class="o">.</span><span class="n">open</span><span class="p">,</span> <span class="n">Status</span><span class="o">.</span><span class="n">pending</span><span class="p">,</span> <span class="n">Status</span><span class="o">.</span><span class="n">closed</span>
<span class="go">(0, 1, 2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Status</span><span class="p">:</span>
<span class="gp">... </span>    <span class="nb">open</span><span class="p">,</span> <span class="n">pending</span><span class="p">,</span> <span class="n">closed</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<p>See also:</p>
<blockquote>
Named tuple recipe adapted for Python 2.4.</blockquote>
</div>
</div>


          </div>
        </div>
      </div>


      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../modindex.html" title="Global Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="heapq.html" title="8.4. heapq — Heap queue algorithm"
             >next</a> |</li>
        <li class="right" >
          <a href="calendar.html" title="8.2. calendar — General calendar-related functions"
             >previous</a> |</li>
        <li><a href="../index.html">Jython v2.5.2 documentation</a> &raquo;</li>
          <li><a href="indexprogress.html" >The Python Standard Library and What Comes with Jython</a> &raquo;</li>
          <li><a href="datatypes.html" >8. Data Types</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
      &copy; <a href="../copyright.html">Copyright</a> 2011, Jython Project.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 0.6.4.
    </div>
  </body>
</html>